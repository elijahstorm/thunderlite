import{a6 as Ye,s as J,f as F,g as L,h as x,d as v,j as R,i as I,y as z,C as M,v as D,a0 as C,$ as w,r as N,X as je,E as se,o as le,p as Se,F as Ee,a as ce,c as fe,I as Ve,J as ze,K as Be,G as Je,a7 as Z,N as Qe,e as ye,a3 as $e}from"./scheduler.0cef3f82.js";import{S as Q,i as $,a as W,t as Y,b as _e,d as me,m as ue,e as pe,g as et,c as tt}from"./index.5079a6aa.js";import{w as B}from"./index.1e0a63b8.js";const nt=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,ve=B({ground:{},units:{},sky:{}}),Te=B({ground:{},units:{},sky:{}}),Oe=e=>t=>{const n=document.createElement("canvas"),o=n.getContext("2d");if(!o)return t;n.width=t.width,n.height=t.height,o.drawImage(t,0,0,n.width,n.height);const[i,a]=[Re[0],Re[e]],r=o.getImageData(0,0,n.width,n.height),s=50;for(let c=0;c<r.data.length;c+=4)for(let f=0;f<a.length;f++){const u=r.data[c]-i[f][0],_=r.data[c+1]-i[f][1],m=r.data[c+2]-i[f][2];Math.abs(u)<s&&Math.abs(_)<s&&Math.abs(m)<s&&(r.data[c]=Math.max(0,Math.min(255,a[f][0]-u)),r.data[c+1]=Math.max(0,Math.min(255,a[f][1]-_)),r.data[c+2]=Math.max(0,Math.min(255,a[f][2]-m)))}o.putImageData(r,0,0);const l=new Image;return l.src=n.toDataURL("image/png"),l},Re=[[[255,144,133],[233,56,46],[170,22,44],[102,26,94],[129,25,75]],[[169,207,255],[69,164,225],[43,95,199],[61,49,127],[25,62,127]],[[142,255,152],[59,255,20],[67,193,56],[22,145,15],[25,127,75]],[[255,255,142],[229,229,43],[206,109,28],[125,137,13],[127,119,25]],[[255,208,204],[232,186,185],[168,134,139],[102,81,99],[129,25,75]]],de=(e,t,n=1)=>o=>i=>Object.entries(t.reduce((a,r,s)=>(a[s]=r,a),{})).filter((a,r)=>i.indexOf(r)!==-1).reduce((a,[r,s])=>{const l=parseInt(r),c=Ye(ve)[e][l];if(c)s.sprite=c;else{s.sprite=new Array(n);for(let f=0;f<n;f++)o(s.url)(u=>{ve.update(_=>(_[e][l]||(_[e][l]=new Array(n)),_[e][l][f]=Oe(f)(u),_)),s.sprite[f]=Oe(f)(u)})}return a[l]=s,a},{}),ge=[{url:"game/play/terrain/plains.png",frames:1,xOffset:0,yOffset:0,connector:2,name:"Plains",description:"Basic terrain",details:"dirty",ocean:!1,protection:.1,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/hills.png",frames:1,xOffset:0,yOffset:0,connector:2,name:"Hills",description:"Gives ranged units an extended range",details:"rough",ocean:!1,protection:.2,damage:0,height:20,drag:2,modifiers:["CURMODS.Properties.Extra_Sight"]},{url:"game/play/terrain/forest.png",frames:1,xOffset:0,yOffset:0,connector:2,name:"Forest",description:"Gives defense boost",details:"rough",ocean:!1,protection:.2,damage:0,height:5,drag:2,modifiers:[]},{url:"game/play/terrain/mountain.png",frames:1,xOffset:0,yOffset:0,connector:2,name:"Mountain",description:"Hard to traverse but gives strong defense",details:"rugged",ocean:!1,protection:.4,damage:0,height:50,drag:2,modifiers:["CURMODS.Properties.Extra_Sight"]},{url:"game/play/terrain/road.png",frames:1,xOffset:0,yOffset:0,connector:1,name:"Road",description:"Easy to traverse but provides no defense",details:"clean",ocean:!1,protection:0,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/canyon.png",frames:1,xOffset:0,yOffset:0,connector:1,name:"Canyon",description:"Dips down, but ranged units cannot target here",details:"slippery",ocean:!1,protection:.3,damage:0,height:-10,drag:1,modifiers:["CURMODS.Properties.Trench"]},{url:"game/play/terrain/wasteland.png",frames:1,xOffset:0,yOffset:0,connector:0,name:"Wasteland",description:"Provides lots of defense, but costs health to rest on",details:"dirty",ocean:!1,protection:.5,damage:10,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/volcano.png",frames:1,xOffset:0,yOffset:34,connector:0,name:"Volcano",description:"Impassable",details:"impassable",ocean:!1,protection:0,damage:0,height:100,drag:100,modifiers:[]},{url:"game/play/terrain/enriched-ore-deposit.png",frames:1,xOffset:0,yOffset:0,connector:0,name:"Enriched Ore Deposit",description:"Can be mined for money",details:"pot-holes",ocean:!1,protection:0,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/ore-deposit.png",frames:1,xOffset:0,yOffset:0,connector:0,name:"Ore Deposit",description:"Can be mined for money",details:"pot-holes",ocean:!1,protection:0,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/depleted-ore-deposit.png",frames:1,xOffset:0,yOffset:0,connector:0,name:"Depleted Ore Deposit",description:"Can be mined for money",details:"pot-holes",ocean:!1,protection:0,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/sea.png",frames:3,xOffset:0,yOffset:0,connector:3,name:"Sea",description:"Basic sea terrain",details:"clean",ocean:!0,protection:0,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/reef.png",frames:3,xOffset:0,yOffset:0,connector:0,name:"Reef",description:"Hard to traverse sea terrain",details:"dirty",ocean:!0,protection:.1,damage:0,height:10,drag:2,modifiers:[]},{url:"game/play/terrain/archipelago.png",frames:3,xOffset:0,yOffset:0,connector:0,name:"Archipelago",description:"Rough sea terrain",details:"rough",ocean:!0,protection:.2,damage:0,height:20,drag:2,modifiers:[]},{url:"game/play/terrain/rock-formation.png",frames:3,xOffset:0,yOffset:0,connector:0,name:"Rock Formation",description:"Rocky sea terrain",details:"rugged",ocean:!0,protection:.7,damage:20,height:0,drag:2,modifiers:[]},{url:"game/play/terrain/shore.png",frames:3,xOffset:0,yOffset:0,connector:3,name:"Shore",description:"An easy access to the sea",details:"rough",ocean:!0,protection:0,damage:0,height:0,drag:1,modifiers:["CURMODS.Properties.Port"]},{url:"game/play/terrain/bridge.png",frames:1,xOffset:0,yOffset:0,connector:4,name:"Bridge",description:"Connects two islands, but provides no defense",details:"clean",ocean:!1,protection:0,damage:0,height:10,drag:1,modifiers:[]},{url:"game/play/terrain/high-bridge.png",frames:1,xOffset:0,yOffset:0,connector:4,name:"High Bridge",description:"Connects two islands, and allows ships to pass, but provides no defense",details:"clean",ocean:!1,protection:0,damage:0,height:20,drag:1,modifiers:[]}],ot=de("ground",ge),y=[1,1],it=[{url:"game/play/units/idle/strike-commando.png",frames:4,yOffset:0,xOffset:0,name:"Strike Commando",description:"Basic land unit",type:0,maxHealth:40,armor:0,power:20,weaponType:0,movement:3,movementType:0,range:y,sight:2,cost:75,actable:!0,modifiers:["CURMODS.Start_Turn.Capture","CURMODS.Move.Tracking","CURMODS.Self_Action.Transport","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('light gun')",moveSFX:"SFXs.Retrieve('footstep')"},{url:"game/play/units/idle/heavy-commando.png",frames:4,yOffset:0,xOffset:0,name:"Heavy Commando",description:"Basic land unit",type:0,maxHealth:40,armor:0,power:35,weaponType:2,movement:3,movementType:0,range:y,sight:2,cost:100,actable:!0,modifiers:["CURMODS.Start_Turn.Capture","CURMODS.Move.Tracking","CURMODS.Self_Action.Transport","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('footstep')"},{url:"game/play/units/idle/flak-tank.png",frames:4,yOffset:60,xOffset:0,name:"Flak Tank",description:"Very effective against air units",type:0,maxHealth:70,armor:1,power:17,weaponType:0,movement:6,movementType:2,range:y,sight:3,cost:240,actable:!0,modifiers:["CURMODS.Can_Attack.Air_Raid","CURMODS.Damage.Flak","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('machine gun')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/scorpion-tank.png",frames:4,yOffset:0,xOffset:0,name:"Scorpion Tank",description:"Basic tank unit",type:0,maxHealth:70,armor:1,power:35,weaponType:1,movement:6,movementType:2,range:y,sight:3,cost:270,actable:!0,modifiers:["CURMODS.Damage.Fast_Attack","CURMODS.Self_Action.Repairable","CURMODS.Can_Attack.Bombard"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/lance-tank.png",frames:4,yOffset:0,xOffset:0,name:"Lance Tank",description:"Can hit space directly behind enemy",type:0,maxHealth:70,armor:1,power:35,weaponType:1,movement:6,movementType:2,range:y,sight:3,cost:270,actable:!0,modifiers:["CURMODS.Attack.Lance","CURMODS.Self_Action.Repairable","CURMODS.Can_Attack.Bombard"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/spider-tank.png",frames:4,yOffset:0,xOffset:0,name:"Spider Tank",description:"Can climb mountains",type:0,maxHealth:40,armor:1,power:40,weaponType:1,movement:4,movementType:0,range:y,sight:3,cost:250,actable:!0,modifiers:["CURMODS.Attack.Stun","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('light gun')",moveSFX:"SFXs.Retrieve('footstep')"},{url:"game/play/units/idle/stealth-tank.png",frames:4,yOffset:0,xOffset:0,name:"Stealth Tank",description:"Can hide itself",type:0,maxHealth:40,armor:1,power:30,weaponType:0,movement:5,movementType:2,range:y,sight:3,cost:340,actable:!0,modifiers:["CURMODS.End_Turn.Cloak","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('distance gun')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/annihilator-tank.png",frames:4,yOffset:60,xOffset:0,name:"Annihilator Tank",description:"Massive tank",type:0,maxHealth:140,armor:2,power:70,weaponType:2,movement:4,movementType:2,range:y,sight:3,cost:525,actable:!0,modifiers:["CURMODS.Damage.Slow_Attack","CURMODS.Self_Action.Repairable","CURMODS.Can_Attack.Bombard"],attackSFX:"SFXs.Retrieve('explosion')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/mortar-truck.png",frames:4,yOffset:60,xOffset:0,name:"Mortar Truck",description:"Heavy distanced attack but with short range",type:0,maxHealth:50,armor:0,power:48,weaponType:1,movement:5,movementType:1,range:[2,3],sight:3,cost:285,actable:!0,modifiers:["CURMODS.Can_Attack.Counter_Range","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/rocket-truck.png",frames:4,yOffset:60,xOffset:0,name:"Rocket Truck",description:"Weaker distanced attack but with long range",type:0,maxHealth:40,armor:0,power:40,weaponType:2,movement:6,movementType:1,range:[3,5],sight:4,cost:470,actable:!0,modifiers:["CURMODS.Can_Attack.Counter_Range","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('explosion')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/jammer-truck.png",frames:4,yOffset:60,xOffset:0,name:"Jammer Truck",description:"Stops air units from entering jammed area and uncloaks hidden units",type:0,maxHealth:50,armor:0,power:0,weaponType:-1,movement:5,movementType:1,range:[],sight:2,cost:300,actable:!0,modifiers:["CURMODS.Move.Radar","CURMODS.Idle.Jamming","CURMODS.Self_Action.Repairable"],attackSFX:null,moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/warmachine.png",frames:4,yOffset:60,xOffset:0,name:"Warmachine",description:"Creates other units",type:0,maxHealth:75,armor:1,power:60,weaponType:2,movement:3,movementType:2,range:[2,3],sight:3,cost:525,Cash:2e3,actable:!0,modifiers:["CURMODS.Self_Action.Miner","CURMODS.Self_Action.Builder","CURMODS.Self_Action.Repairable","CURMODS.Death.Insta_Lose"],attackSFX:"SFXs.Retrieve('explosion')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/intrepid.png",frames:4,yOffset:0,xOffset:0,name:"Intrepid",description:"Can capture sea buildings",type:2,maxHealth:50,armor:0,power:15,weaponType:0,movement:6,movementType:6,rlow:!1,sange:y,cost:200,actable:!0,modifiers:["CURMODS.Start_Turn.Capture","CURMODS.Move.Tracking","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('machine gun')",moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/corvette.png",frames:4,yOffset:60,xOffset:0,name:"Corvette",description:"Basic sea unit",type:2,maxHealth:90,armor:1,power:45,weaponType:1,movement:5,movementType:8,range:y,sight:4,cost:500,actable:!0,modifiers:["CURMODS.Can_Attack.Ground_Assult","CURMODS.Damage.Fast_Attack"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/hunter-support.png",frames:4,yOffset:60,xOffset:0,name:"Hunter Support",description:"Can attack air units",type:2,maxHealth:90,armor:1,power:17,weaponType:0,movement:5,movementType:6,range:y,sight:4,cost:450,actable:!0,modifiers:["CURMODS.Can_Attack.Air_Raid","CURMODS.Damage.Flak","CURMODS.Move.Tracking","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('machine gun')",moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/u-boat.png",frames:4,yOffset:60,xOffset:0,name:"U-Boat",description:"Can hide underwater",type:2,maxHealth:25,armor:0,power:35,weaponType:2,movement:4,movementType:7,range:y,sight:4,cost:475,actable:!0,modifiers:["CURMODS.End_Turn.Cloak","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/raptor-fighter.png",frames:4,yOffset:60,xOffset:0,name:"Raptor Fighter",description:"Basic air unit",type:1,maxHealth:50,armor:0,power:25,weaponType:0,movement:8,movementType:4,range:y,sight:5,cost:235,actable:!0,modifiers:["CURMODS.Can_Attack.Air_Raid","CURMODS.Self_Action.Irreparable"],attackSFX:"SFXs.Retrieve('machine gun')",moveSFX:"SFXs.Retrieve('jet')"},{url:"game/play/units/idle/condor-bomber.png",frames:4,yOffset:60,xOffset:0,name:"Condor Bomber",description:"Drops bombs of massive damage",type:1,maxHealth:40,armor:1,power:70,weaponType:2,movement:4,movementType:4,range:y,sight:3,cost:600,actable:!0,modifiers:["CURMODS.Self_Action.Repairable","CURMODS.Can_Attack.Bombard"],attackSFX:"SFXs.Retrieve('explosion')",moveSFX:"SFXs.Retrieve('air')"},{url:"game/play/units/idle/vulture-drone.png",frames:4,yOffset:60,xOffset:0,name:"Vulture Drone",description:"Can move again if attack kills",type:1,maxHealth:55,armor:1,power:30,weaponType:1,movement:5,movementType:3,range:y,sight:5,cost:550,actable:!0,modifiers:["CURMODS.End_Turn.Vulture","CURMODS.Self_Action.Repairable","CURMODS.Can_Attack.Bombard"],attackSFX:"SFXs.Retrieve('distance gun')",moveSFX:"SFXs.Retrieve('jet')"},{url:"game/play/units/idle/turret.png",frames:4,yOffset:60,xOffset:0,name:"Turret",description:"Basic turret unit",type:0,maxHealth:100,armor:1,power:40,weaponType:1,movement:0,movementType:9,range:[2,5],sight:5,cost:0,actable:!0,modifiers:["CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('distance gun')",moveSFX:"SFXs.Retrieve('quite')"},{url:"game/play/units/idle/blockade.png",frames:4,yOffset:0,xOffset:0,name:"Blockade",description:"Cannot move or attack, but enemies cannot cross",type:0,maxHealth:70,armor:1,power:0,weaponType:0,movement:0,movementType:9,range:[0,0],sight:0,cost:0,actable:!1,modifiers:["CURMODS.Self_Action.Irreparable"],attackSFX:null,moveSFX:"SFXs.Retrieve('quite')"},{url:"game/play/units/idle/battle-cruiser.png",frames:4,yOffset:60,xOffset:0,name:"Battle Cruiser",description:"Can attack from the farthest distance in the game",type:2,maxHealth:140,armor:2,power:55,weaponType:2,movement:4,movementType:8,range:[2,6],sight:6,cost:800,actable:!0,modifiers:["CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/leviathan.png",frames:4,yOffset:60,xOffset:0,name:"Leviathan",description:"Can ship across water",type:2,maxHealth:60,armor:1,power:0,weaponType:2,movement:4,movementType:7,range:y,sight:2,cost:0,actable:!0,modifiers:["CURMODS.Self_Action.Land","CURMODS.Self_Action.Repairable"],attackSFX:null,moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/transporter.png",frames:4,yOffset:60,xOffset:0,name:"Transporter",description:"Can transport a non-air unit through the air",type:1,maxHealth:50,armor:0,power:0,weaponType:0,movement:6,movementType:3,range:[0,0],sight:3,cost:0,actable:!0,modifiers:["CURMODS.Self_Action.Land","CURMODS.Self_Action.Repairable"],attackSFX:null,moveSFX:"SFXs.Retrieve('air')"}],at=de("units",it,4),Jt=e=>{const[t,n]=(o=>{let i=0,a=0;const r=s=>{s(),o(a===i)};return[()=>r(()=>i++),s=>()=>r(()=>{a++,s()})]})(e);return o=>i=>{t(),fetch(o).then(a=>a.blob()).then(a=>{const r=new Image;r.src=URL.createObjectURL(a),r.onload=n(()=>i(r))}).catch(a=>{console.error("Error fetching image:",a)})}},Qt="http://127.0.0.1:5173/",rt="ThunderLite Local",st=()=>({__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__tileWidth:0,__tileHeight:0,setup:function({clientWidth:e,clientHeight:t,contentWidth:n,contentHeight:o,tileWidth:i,tileHeight:a}){this.__clientWidth=e,this.__clientHeight=t,this.__contentWidth=n,this.__contentHeight=o,this.__tileWidth=i,this.__tileHeight=a},render:function(e,t){return(n,o,i)=>{e(n,o,i);const a=this.__clientHeight,r=this.__clientWidth,s=this.__tileHeight*i,l=this.__tileWidth*i,c=Math.max(Math.floor(o/s),0),f=Math.max(Math.floor(n/l),0),u=this.__contentHeight*i/s,_=this.__contentWidth*i/l,m=o>=0?-o%s:-o,d=n>=0?-n%l:-n;let g=Math.floor(a/s);o%s>0&&(g+=1),m+g*s<a&&(g+=1);let S=Math.floor(r/l);n%l>0&&(S+=1),d+S*l<r&&(S+=1),g=Math.min(g,u-c),S=Math.min(S,_-f);let O=m,b=d;for(let h=c;h<g+c;h++){for(let T=f;T<S+f;T++)t(h,T,b,O,l,s,i),b+=l;b=d,O+=s}}}}),ie=60,ae=1e3;let X=[],lt=1;const U={requestAnimationFrame:function(){const e=typeof window<"u"?window.requestAnimationFrame:()=>{};let t=!!e;if(e&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(e.toString())&&(t=!1),t)return function(s){e(s)};const n=60;let o={},i=1,a=null,r=performance.now();return function(s){const l=i++;return o[l]=s,a===null&&(a=setInterval(function(){const c=performance.now(),f=o;o={};for(const u in f)f[u]&&(f[u](c),r=c);c-r>2500&&a&&(clearInterval(a),a=null)},1e3/n)),l}}(),stop:function(e){const t=X[e]!==null;return t&&(X[e]=null),t},isRunning:function(e){return X[e]!=null},start:function(e,t,n,o,i,a){const r=performance.now();let s=r,l=0,c=0;const f=lt++;if(f%20===0){const m=[];for(const d in X)m[d]=!0;X=m}const u=m=>d=>{if(!X[f]||t&&!t(f)){X[f]=null,n&&n(ie-c/((d-r)/ae),f);return}if(m){const S=Math.round((d-s)/(ae/ie))-1;for(let O=0;O<Math.min(S,4);O++)_(),c++}o&&(l=(d-r)/o,l>1&&(l=1));const g=i?i(l):l;(e(g,d,m)===!1||l===1)&&m?(X[f]=null,n&&n(ie-c/((d-r)/ae),f)):m&&(s=d,this.requestAnimationFrame(u(!0)))},_=()=>{u(!1)(performance.now())};return X[f]=!0,this.requestAnimationFrame(u(!0)),f}},ct=function(e){return Math.pow(e-1,3)+1},ft=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},_t=function(){const e={__isSingleTouch:!1,__isTracking:!1,__didDecelerationComplete:!1,__isGesturing:!1,__isDragging:!1,__isDecelerating:0,__isAnimating:0,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:!1,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:[],__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,setPosition:function(t,n){},setDimensions:function(t,n,o,i){},__computeScrollMax:function(t){},scrollTo:function(t,n,o,i){},setSnapSize:function(t,n){},activatePullToRefresh:function(t,n,o,i){},triggerPullToRefresh:()=>{},finishPullToRefresh:()=>{},getValues:function(){return{left:0,top:0,zoom:0}},getScrollMax:function(){return{left:0,top:0}},zoomTo:function(t,n,o,i,a){},options:{scrollingX:void 0,scrollingY:void 0,animating:void 0,animationDuration:void 0,bouncing:void 0,locking:void 0,paging:void 0,snapping:void 0,zooming:void 0,minZoom:void 0,maxZoom:void 0,speedMultiplier:void 0,scrollingComplete:void 0,penetrationDeceleration:void 0,penetrationAcceleration:void 0},__zoomComplete:null,__publish:function(t,n,o,i){},zoomBy:function(t,n,o,i,a){},scrollBy:function(t,n,o){},doMouseZoom:function(t,n,o,i){},doTouchStart:function(t,n){},__interruptedAnimation:!1,__initialTouchLeft:0,__initialTouchTop:0,__zoomLevelStart:0,__lastScale:0,__enableScrollX:!1,__enableScrollY:!1,doTouchMove:function(t,n,o){},doTouchEnd:function(t){},__startDeceleration:()=>{},customRender:function(t,n,o){},__stepThroughDeceleration:function(t){}};return e.setDimensions=function(t,n,o,i){t===+t&&(e.__clientWidth=t),n===+n&&(e.__clientHeight=n),o===+o&&(e.__contentWidth=o),i===+i&&(e.__contentHeight=i),e.__computeScrollMax(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},e.setPosition=function(t,n){e.__clientLeft=t||0,e.__clientTop=n||0},e.setSnapSize=function(t,n){e.__snapWidth=t,e.__snapHeight=n},e.activatePullToRefresh=function(t,n,o,i){e.__refreshHeight=t,e.__refreshActivate=n,e.__refreshDeactivate=o,e.__refreshStart=i},e.triggerPullToRefresh=function(){e.__publish(e.__scrollLeft,e.__refreshHeight?-e.__refreshHeight:0,e.__zoomLevel,!0),e.__refreshStart&&e.__refreshStart()},e.finishPullToRefresh=function(){e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},e.getValues=function(){return{left:e.__scrollLeft,top:e.__scrollTop,zoom:e.__zoomLevel}},e.getScrollMax=function(){return{left:e.__maxScrollLeft,top:e.__maxScrollTop}},e.zoomTo=function(t,n,o,i,a){if(!e.options.zooming)return;a&&(e.__zoomComplete=a),e.__isDecelerating&&(U.stop(e.__isDecelerating),e.__isDecelerating=0);const r=e.__zoomLevel;o==null&&(o=e.__clientWidth/2),i==null&&(i=e.__clientHeight/2),t=Math.max(Math.min(t,e.options.maxZoom??3),e.options.minZoom??.5),e.__computeScrollMax(t);let s=(o+e.__scrollLeft)*t/r-o,l=(i+e.__scrollTop)*t/r-i;s>e.__maxScrollLeft?s=e.__maxScrollLeft:s<0&&(s=0),l>e.__maxScrollTop?l=e.__maxScrollTop:l<0&&(l=0),e.__publish(s,l,t,n)},e.zoomBy=function(t,n,o,i,a){e.zoomTo(e.__zoomLevel*t,n,o,i,a)},e.scrollTo=function(t,n,o,i){if(e.__isDecelerating&&(U.stop(e.__isDecelerating),e.__isDecelerating=0),i&&i!==e.__zoomLevel){if(!e.options.zooming)return;t*=i,n*=i,e.__computeScrollMax(i)}else i=e.__zoomLevel;e.options.scrollingX?e.options.paging?t=Math.round(t/e.__clientWidth)*e.__clientWidth:e.options.snapping&&(t=Math.round(t/e.__snapWidth)*e.__snapWidth):t=e.__scrollLeft,e.options.scrollingY?e.options.paging?n=Math.round(n/e.__clientHeight)*e.__clientHeight:e.options.snapping&&(n=Math.round(n/e.__snapHeight)*e.__snapHeight):n=e.__scrollTop,t=Math.max(Math.min(e.__maxScrollLeft,t),0),n=Math.max(Math.min(e.__maxScrollTop,n),0),t===e.__scrollLeft&&n===e.__scrollTop&&(o=!1),e.__isTracking||e.__publish(t,n,i,o)},e.scrollBy=function(t,n,o){const i=e.__isAnimating?e.__scheduledLeft:e.__scrollLeft,a=e.__isAnimating?e.__scheduledTop:e.__scrollTop;e.scrollTo(i+(t||0),a+(n||0),o)},e.doMouseZoom=function(t,n,o,i){const a=t>0?.97:1.03;e.zoomTo(e.__zoomLevel*a,!1,o-e.__clientLeft,i-e.__clientTop)},e.doTouchStart=function(t,n){if(t.length==null)throw new Error("Invalid touch list: "+t);if(typeof n!="number")throw new Error("Invalid timestamp value: "+n);e.__interruptedAnimation=!0,e.__isDecelerating&&(U.stop(e.__isDecelerating),e.__isDecelerating=0,e.__interruptedAnimation=!0),e.__isAnimating&&(U.stop(e.__isAnimating),e.__isAnimating=0,e.__interruptedAnimation=!0);let o,i;const a=t.length===1;a?(o=t[0].pageX,i=t[0].pageY):(o=Math.abs(t[0].pageX+t[1].pageX)/2,i=Math.abs(t[0].pageY+t[1].pageY)/2),e.__initialTouchLeft=o,e.__initialTouchTop=i,e.__zoomLevelStart=e.__zoomLevel,e.__lastTouchLeft=o,e.__lastTouchTop=i,e.__lastTouchMove=n,e.__lastScale=1,e.__enableScrollX=!a&&e.options.scrollingX||!1,e.__enableScrollY=!a&&e.options.scrollingY||!1,e.__isTracking=!0,e.__didDecelerationComplete=!1,e.__isDragging=!a,e.__isSingleTouch=a,e.__positions=[]},e.doTouchMove=function(t,n,o){if(t.length==null)throw new Error("Invalid touch list: "+t);if(typeof n!="number")throw new Error("Invalid timestamp value: "+n);if(!e.__isTracking)return!1;let i,a;t.length===2?(i=Math.abs(t[0].pageX+t[1].pageX)/2,a=Math.abs(t[0].pageY+t[1].pageY)/2):(i=t[0].pageX,a=t[0].pageY);const r=e.__positions;if(e.__isDragging&&e.__lastTouchLeft&&e.__lastTouchTop){const s=i-e.__lastTouchLeft,l=a-e.__lastTouchTop;let c=e.__scrollLeft,f=e.__scrollTop,u=e.__zoomLevel;if(o!=null&&e.options.zooming){const _=u;if(u=u/e.__lastScale*o,u=Math.max(Math.min(u,e.options.maxZoom??3),e.options.minZoom??.5),_!==u){const m=i-e.__clientLeft,d=a-e.__clientTop;c=(m+c)*u/_-m,f=(d+f)*u/_-d,e.__computeScrollMax(u)}}if(e.__enableScrollX&&e.options.speedMultiplier){c-=s*e.options.speedMultiplier;const _=e.__maxScrollLeft;(c>_||c<0)&&(e.options.bouncing?c+=s/2*e.options.speedMultiplier:c>_?c=_:c=0)}if(e.__enableScrollY&&e.options.speedMultiplier){f-=l*e.options.speedMultiplier;const _=e.__maxScrollTop;(f>_||f<0)&&(e.options.bouncing?(f+=l/2*e.options.speedMultiplier,!e.__enableScrollX&&e.__refreshHeight!=null&&(!e.__refreshActive&&f<=-e.__refreshHeight?(e.__refreshActive=!0,e.__refreshActivate&&e.__refreshActivate()):e.__refreshActive&&f>-e.__refreshHeight&&(e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate()))):f>_?f=_:f=0)}r&&r.length>60&&r.splice(0,30),r==null||r.push(c,f,n),e.__publish(c,f,u)}else{const s=e.options.locking?3:0,l=5,c=Math.abs(i-e.__initialTouchLeft),f=Math.abs(a-e.__initialTouchTop);e.__enableScrollX=e.options.scrollingX&&c>=s,e.__enableScrollY=e.options.scrollingY&&f>=s,r==null||r.push(e.__scrollLeft,e.__scrollTop,n),e.__isDragging=(e.__enableScrollX||e.__enableScrollY)&&(c>=l||f>=l),e.__isDragging&&(e.__interruptedAnimation=!1)}return e.__lastTouchLeft=i,e.__lastTouchTop=a,e.__lastTouchMove=n,o&&(e.__lastScale=o),!0},e.doTouchEnd=function(t){if(typeof t!="number")throw new Error("Invalid timestamp value: "+t);if(e.__isTracking){if(e.__isTracking=!1,e.__isDragging)if(e.__isDragging=!1,e.__isSingleTouch&&e.options.animating&&e.__lastTouchMove&&t-e.__lastTouchMove<=100){const n=e.__positions,o=n.length-1;let i=o;for(let a=o;a>0&&n[a]>e.__lastTouchMove-100;a-=3)i=a;if(i!==o){const a=n[o]-n[i],r=e.__scrollLeft-n[i-2],s=e.__scrollTop-n[i-1];e.__decelerationVelocityX=r/a*(1e3/60),e.__decelerationVelocityY=s/a*(1e3/60);const l=e.options.paging||e.options.snapping?4:1;Math.abs(e.__decelerationVelocityX)>l||Math.abs(e.__decelerationVelocityY)>l?e.__refreshActive||e.__startDeceleration():e.options.scrollingComplete&&e.options.scrollingComplete()}else e.options.scrollingComplete&&e.options.scrollingComplete()}else e.__lastTouchMove&&t-e.__lastTouchMove>100&&e.options.scrollingComplete&&e.options.scrollingComplete();e.__isDecelerating||(e.__refreshActive&&e.__refreshStart?(e.__publish(e.__scrollLeft,e.__refreshHeight?-e.__refreshHeight:0,e.__zoomLevel,!0),e.__refreshStart&&e.__refreshStart()):((e.__interruptedAnimation||e.__isDragging)&&e.options.scrollingComplete&&e.options.scrollingComplete(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0,e.__zoomLevel),e.__refreshActive&&(e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate()))),e.__positions=[]}},e.__publish=function(t,n,o,i){const a=e.__isAnimating;if(a&&(U.stop(a),e.__isAnimating=0),i&&e.options.animating){e.__scheduledLeft=t,e.__scheduledTop=n,e.__scheduledZoom=o;const r=e.__scrollLeft,s=e.__scrollTop,l=e.__zoomLevel,c=t-r,f=n-s,u=o-l,_=function(g,S,O){O&&(e.__scrollLeft=r+c*g,e.__scrollTop=s+f*g,e.__zoomLevel=l+u*g,e.customRender&&e.customRender(e.__scrollLeft,e.__scrollTop,e.__zoomLevel))},m=function(g){return e.__isAnimating===g},d=function(g,S){g===e.__isAnimating&&(e.__isAnimating=0),(e.__didDecelerationComplete||S)&&e.options.scrollingComplete&&e.options.scrollingComplete(),e.options.zooming&&(e.__computeScrollMax(),e.__zoomComplete&&(e.__zoomComplete(),e.__zoomComplete=null))};e.__isAnimating=U.start(_,m,d,e.options.animationDuration??0,a?ct:ft)}else e.__scheduledLeft=e.__scrollLeft=t,e.__scheduledTop=e.__scrollTop=n,e.__scheduledZoom=e.__zoomLevel=o,e.customRender&&e.customRender(t,n,o),e.options.zooming&&(e.__computeScrollMax(),e.__zoomComplete&&(e.__zoomComplete(),e.__zoomComplete=null))},e.__computeScrollMax=function(t){t==null&&(t=e.__zoomLevel),e.__maxScrollLeft=Math.max(e.__contentWidth*t-e.__clientWidth,0),e.__maxScrollTop=Math.max(e.__contentHeight*t-e.__clientHeight,0)},e.__startDeceleration=function(){if(e.options.paging){const a=Math.max(Math.min(e.__scrollLeft,e.__maxScrollLeft),0),r=Math.max(Math.min(e.__scrollTop,e.__maxScrollTop),0),s=e.__clientWidth,l=e.__clientHeight;e.__minDecelerationScrollLeft=Math.floor(a/s)*s,e.__minDecelerationScrollTop=Math.floor(r/l)*l,e.__maxDecelerationScrollLeft=Math.ceil(a/s)*s,e.__maxDecelerationScrollTop=Math.ceil(r/l)*l}else e.__minDecelerationScrollLeft=0,e.__minDecelerationScrollTop=0,e.__maxDecelerationScrollLeft=e.__maxScrollLeft,e.__maxDecelerationScrollTop=e.__maxScrollTop;const t=function(a,r,s){e.__stepThroughDeceleration(s)},n=e.options.snapping?4:.001,o=function(){if(!e.__decelerationVelocityX||!e.__decelerationVelocityY)return!1;const a=Math.abs(e.__decelerationVelocityX)>=n||Math.abs(e.__decelerationVelocityY)>=n;return a||(e.__didDecelerationComplete=!0),a},i=function(){e.__isDecelerating=0,e.__didDecelerationComplete&&e.options.scrollingComplete&&e.options.scrollingComplete(),e.scrollTo(e.__scrollLeft,e.__scrollTop,e.options.snapping)};e.__isDecelerating=U.start(t,o,i)},e.__stepThroughDeceleration=function(t){if(!e.__decelerationVelocityY||!e.__decelerationVelocityX)return;let n=e.__scrollLeft+e.__decelerationVelocityX,o=e.__scrollTop+e.__decelerationVelocityY;if(!e.options.bouncing){const i=Math.max(Math.min(e.__maxDecelerationScrollLeft??n,n),e.__minDecelerationScrollLeft??n);i!==n&&(n=i,e.__decelerationVelocityX=0);const a=Math.max(Math.min(e.__maxDecelerationScrollTop??o,o),e.__minDecelerationScrollTop??o);a!==o&&(o=a,e.__decelerationVelocityY=0)}if(t?e.__publish(n,o,e.__zoomLevel):(e.__scrollLeft=n,e.__scrollTop=o),e.options.paging||(e.__decelerationVelocityX*=.95,e.__decelerationVelocityY*=.95),e.options.bouncing){let i=0,a=0;const r=e.options.penetrationDeceleration,s=e.options.penetrationAcceleration;e.__minDecelerationScrollLeft&&n<e.__minDecelerationScrollLeft?i=e.__minDecelerationScrollLeft-n:e.__maxDecelerationScrollLeft&&n>e.__maxDecelerationScrollLeft&&(i=e.__maxDecelerationScrollLeft-n),e.__minDecelerationScrollTop&&o<e.__minDecelerationScrollTop?a=e.__minDecelerationScrollTop-o:e.__maxDecelerationScrollTop&&o>e.__maxDecelerationScrollTop&&(a=e.__maxDecelerationScrollTop-o),i!==0&&(r&&i*e.__decelerationVelocityX<=0?e.__decelerationVelocityX+=i*r:s&&(e.__decelerationVelocityX=i*s)),a!==0&&(r&&a*e.__decelerationVelocityY<=0?e.__decelerationVelocityY+=a*r:s&&(e.__decelerationVelocityY=a*s))}},e},mt={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,scrollingComplete:()=>{},penetrationDeceleration:.03,penetrationAcceleration:.08},ut=function(e,t){t={...mt,...t};const n=_t();return n.customRender=e,n.options=t,n},he=B(0),V=B(),be=(e,t)=>n=>o=>ee(te,gt(t))(n,o.pageX-e.left+t.__scrollLeft,o.pageY-e.top+t.__scrollTop)(o),Me=e=>t=>ee(te,dt)(e,t.key,t.shiftKey)(t),De=e=>t=>ee(te)(e.doTouchStart,t.touches,t.timeStamp)(t),ke=e=>t=>e.doTouchMove(t.touches,t.timeStamp),Ce=e=>t=>e.doTouchEnd(t.timeStamp),we=e=>t=>e.doTouchEnd(t.timeStamp),Xe=e=>t=>ee(te)(e.doTouchStart,[{pageX:t.pageX,pageY:t.pageY}],t.timeStamp)(t),Fe=e=>t=>e.doTouchEnd(t.timeStamp),Le=e=>t=>e??t,Ae=(e,t)=>n=>o=>pt(ht)(t.doTouchMove,[{pageX:o.pageX,pageY:o.pageY}],o.timeStamp)(n,o.pageX-e.left+t.__scrollLeft,o.pageY-e.top+t.__scrollTop)(t),pt=e=>(t,...n)=>(o,...i)=>a=>e(a)?t(...n):o(...i),ee=(...e)=>(t,...n)=>o=>e.reduce((i,a)=>i?a(o):!1,!0)?t(...n):null,dt=e=>e.key==="Enter",te=e=>!e.target.tagName.match(/input|textarea|select/i),gt=e=>t=>Math.abs(e.__initialTouchLeft-t.pageX)<10&&Math.abs(e.__initialTouchTop-t.pageY)<10,ht=e=>e.__isTracking,{window:St}=nt;function yt(e){let t,n,o,i;return{c(){t=F("section"),n=F("canvas"),this.h()},l(a){t=L(a,"SECTION",{role:!0,tabindex:!0,class:!0});var r=x(t);n=L(r,"CANVAS",{}),x(n).forEach(v),r.forEach(v),this.h()},h(){R(t,"role","grid"),R(t,"tabindex","0"),R(t,"class","h-full outline-none")},m(a,r){I(a,t,r),z(t,n),e[15](n),e[16](t),o||(i=[M(St,"resize",function(){D(e[6])&&e[6].apply(this,arguments)}),M(t,"click",C(w(function(){D(be(e[4].getBoundingClientRect(),e[3])(e[0]))&&be(e[4].getBoundingClientRect(),e[3])(e[0]).apply(this,arguments)}))),M(t,"keypress",function(){D(Me(e[2]))&&Me(e[2]).apply(this,arguments)}),M(t,"touchstart",C(w(function(){D(De(e[3]))&&De(e[3]).apply(this,arguments)}))),M(t,"touchmove",C(w(function(){D(ke(e[3]))&&ke(e[3]).apply(this,arguments)}))),M(t,"touchend",C(w(function(){D(Ce(e[3]))&&Ce(e[3]).apply(this,arguments)}))),M(t,"touchcancel",C(w(function(){D(we(e[3]))&&we(e[3]).apply(this,arguments)}))),M(t,"mousedown",C(w(function(){D(Xe(e[3]))&&Xe(e[3]).apply(this,arguments)}))),M(t,"mouseup",C(w(function(){D(Fe(e[3]))&&Fe(e[3]).apply(this,arguments)}))),M(t,"contextmenu",C(w(function(){D(Le(e[3]))&&Le(e[3]).apply(this,arguments)}))),M(t,"mousemove",C(w(function(){D(Ae(e[4].getBoundingClientRect(),e[3])(e[1]))&&Ae(e[4].getBoundingClientRect(),e[3])(e[1]).apply(this,arguments)})))],o=!0)},p(a,[r]){e=a},i:N,o:N,d(a){a&&v(t),e[15](null),e[16](null),o=!1,je(i)}}}function vt(e,t,n){let o;se(e,he,p=>n(14,o=p));let{tileWidth:i}=t,{tileHeight:a}=t,{contentWidth:r}=t,{contentHeight:s}=t,{requestRedraw:l=0}=t,{handleClick:c}=t,{handleHover:f}=t,{handleOffset:u}=t,{handleKeypress:_}=t,m,d,g,S,O,b;const h=()=>b&&!(m!=null&&m.__isDecelerating)&&!(m!=null&&m.__isTracking)&&b();let{paint:T=p=>(P,E,q,Ne,Ke,Ge,oe)=>{p.save(),p.translate(q,Ne),p.fillStyle=P%2+E%2>0?"#ddd":"#fff",p.fillRect(0,0,Ke,Ge),p.fillStyle="black",p.font=(14*oe).toFixed(2)+'px "Helvetica Neue", Helvetica, Arial, sans-serif',p.fillText(`${P}, ${E}`,6*oe,18*oe),p.restore()}}=t;le(()=>{const p=g.getContext("2d");if(!p)return;S=p,O=st(),n(3,m=ut(O.render(u,T(S)),{bouncing:!1,locking:!1}));let P=d.getBoundingClientRect();m.setPosition(P.left+d.clientLeft,P.top+d.clientTop),n(6,b=()=>{const E=d.clientWidth,q=d.clientHeight;n(5,g.width=E,g),n(5,g.height=q,g),O.setup({clientWidth:E,clientHeight:q,contentWidth:r,contentHeight:s,tileWidth:i,tileHeight:a}),n(3,m.options.locking=window.innerWidth<=768,m),m.setDimensions(E,q,r,s)}),b(),d.focus()});function k(p){Se[p?"unshift":"push"](()=>{g=p,n(5,g)})}function A(p){Se[p?"unshift":"push"](()=>{d=p,n(4,d)})}return e.$$set=p=>{"tileWidth"in p&&n(7,i=p.tileWidth),"tileHeight"in p&&n(8,a=p.tileHeight),"contentWidth"in p&&n(9,r=p.contentWidth),"contentHeight"in p&&n(10,s=p.contentHeight),"requestRedraw"in p&&n(11,l=p.requestRedraw),"handleClick"in p&&n(0,c=p.handleClick),"handleHover"in p&&n(1,f=p.handleHover),"handleOffset"in p&&n(12,u=p.handleOffset),"handleKeypress"in p&&n(2,_=p.handleKeypress),"paint"in p&&n(13,T=p.paint)},e.$$.update=()=>{e.$$.dirty&19968&&h()},[c,f,_,m,d,g,b,i,a,r,s,l,u,T,o,k,A]}class Tt extends Q{constructor(t){super(),$(this,t,vt,yt,J,{tileWidth:7,tileHeight:8,contentWidth:9,contentHeight:10,requestRedraw:11,handleClick:0,handleHover:1,handleOffset:12,handleKeypress:2,paint:13})}}const Ot=e=>({}),He=e=>({handleClick:e[5],handleHover:e[6],handleKeypress:e[8],handleOffset:e[7],cellWidth:e[3],cellHeight:e[4]});function xe(e){let t,n,o,i;return{c(){t=F("div"),n=F("div"),o=ce(),i=F("div"),this.h()},l(a){t=L(a,"DIV",{class:!0});var r=x(t);n=L(r,"DIV",{class:!0,style:!0}),x(n).forEach(v),o=fe(r),i=L(r,"DIV",{class:!0,style:!0}),x(i).forEach(v),r.forEach(v),this.h()},h(){R(n,"class","absolute border-2 border-red-500"),R(n,"style",e[2]),R(i,"class","absolute bg-yellow-500 opacity-30"),R(i,"style",e[1]),R(t,"class","col-start-1 row-start-1 pointer-events-none relative")},m(a,r){I(a,t,r),z(t,n),z(t,o),z(t,i)},p(a,r){r&4&&R(n,"style",a[2]),r&2&&R(i,"style",a[1])},d(a){a&&v(t)}}}function Rt(e){let t,n,o,i;const a=e[13].default,r=Ee(a,e,e[12],He);let s=!e[0]&&xe(e);return{c(){t=F("section"),n=F("div"),r&&r.c(),o=ce(),s&&s.c(),this.h()},l(l){t=L(l,"SECTION",{class:!0});var c=x(t);n=L(c,"DIV",{class:!0});var f=x(n);r&&r.l(f),f.forEach(v),o=fe(c),s&&s.l(c),c.forEach(v),this.h()},h(){R(n,"class","col-start-1 row-start-1 cursor-pointer"),R(t,"class","grid flex-grow overflow-clip")},m(l,c){I(l,t,c),z(t,n),r&&r.m(n,null),z(t,o),s&&s.m(t,null),i=!0},p(l,[c]){r&&r.p&&(!i||c&4096)&&Ve(r,a,l,l[12],i?Be(a,l[12],c,Ot):ze(l[12]),He),l[0]?s&&(s.d(1),s=null):s?s.p(l,c):(s=xe(l),s.c(),s.m(t,null))},i(l){i||(W(r,l),i=!0)},o(l){Y(r,l),i=!1},d(l){l&&v(t),r&&r.d(l),s&&s.d()}}}function bt(e,t,n){let o,i,{$$slots:a={},$$scope:r}=t,{interfacer:s}=t,{select:l}=t,{validTile:c}=t,{mini:f=!1}=t;const u=f?20:60,_=u,m=(h,T)=>{const[k,A]=[O(h),b(T)];c(k,A)&&(l(k,A),n(9,s.selected={x:k,y:A},s))},d=(h,T)=>{const[k,A]=[O(h),b(T)];c(k,A)&&n(9,s.hover={x:k,y:A},s)},g=(h,T,k)=>{n(9,s.offset={x:h,y:T,zoom:k},s)},S=(h,T)=>{n(9,s.key.key=h,s),n(9,s.key.shift=T,s)},O=h=>Math.floor(h/u),b=h=>Math.floor(h/_);return e.$$set=h=>{"interfacer"in h&&n(9,s=h.interfacer),"select"in h&&n(10,l=h.select),"validTile"in h&&n(11,c=h.validTile),"mini"in h&&n(0,f=h.mini),"$$scope"in h&&n(12,r=h.$$scope)},e.$$.update=()=>{e.$$.dirty&512&&n(2,o=`left: ${s.selected.x*u-s.offset.x}px; top: ${s.selected.y*_-s.offset.y}px; width: ${u}px; height: ${_}px`),e.$$.dirty&512&&n(1,i=`left: ${s.hover.x*u-s.offset.x}px; top: ${s.hover.y*_-s.offset.y}px; width: ${u}px; height: ${_}px`)},[f,i,o,u,_,m,d,g,S,s,l,c,r,a]}class Mt extends Q{constructor(t){super(),$(this,t,bt,Rt,J,{interfacer:9,select:10,validTile:11,mini:0})}}const Dt=[{url:"game/play/weather/cloud.png",frames:5,xOffset:0,yOffset:0},{url:"game/play/weather/storm.png",frames:5,xOffset:0,yOffset:0}],kt=de("sky",Dt),Ct=e=>({select:e&1}),Ue=e=>({interfacer:e[2],select:e[0],validTile:e[1],renderData:e[3]});function wt(e){let t;const n=e[7].default,o=Ee(n,e,e[6],Ue);return{c(){o&&o.c()},l(i){o&&o.l(i)},m(i,a){o&&o.m(i,a),t=!0},p(i,[a]){o&&o.p&&(!t||a&65)&&Ve(o,n,i,i[6],t?Be(n,i[6],a,Ct):ze(i[6]),Ue)},i(i){t||(W(o,i),t=!0)},o(i){Y(o,i),t=!1},d(i){o&&o.d(i)}}}function Xt(e,t,n){let o;se(e,Te,_=>n(8,o=_));let{$$slots:i={},$$scope:a}=t,{map:r}=t,{makeImage:s}=t,{select:l=(_,m)=>{const d=m*r.cols+_;console.log(d,_,m)}}=t,c=(_,m)=>_<r.cols&&m<r.rows;const f=(()=>({selected:{x:-1,y:-1},hover:{x:-1,y:-1},offset:{x:0,y:0,zoom:1},key:{key:"",shift:!1}}))();let u={ground:_=>o.ground[_],unit:_=>typeof _<"u"?o.units[_]??null:null,sky:_=>typeof _<"u"?o.sky[_]??null:null};return le(()=>{const _=ot(s)(r.filters.ground(r.layers.ground)),m=at(s)(r.filters.units(r.layers.units)),d=kt(s)(r.filters.sky(r.layers.sky));Te.update(g=>(g.ground={...g.ground,..._},g.units={...g.units,...m},g.sky={...g.sky,...d},g))}),e.$$set=_=>{"map"in _&&n(4,r=_.map),"makeImage"in _&&n(5,s=_.makeImage),"select"in _&&n(0,l=_.select),"$$scope"in _&&n(6,a=_.$$scope)},[l,c,f,u,r,s,a,i]}class Ft extends Q{constructor(t){super(),$(this,t,Xt,wt,J,{map:4,makeImage:5,select:0})}}const j=60,Pe=(e,t)=>(n,o,i)=>a=>a.drawImage(e.sprite[t.team??0],t.state*(j+e.xOffset),i%e.frames*(j+e.yOffset),j+e.xOffset,j+e.yOffset,-e.xOffset,-e.yOffset,n+e.xOffset,o+e.yOffset),Lt=(e,t)=>Pe(e(t.type),t),Ie=(e,t)=>t?Pe(e(t.type),t):null,We=e=>t=>n=>(o,i,a,r,s,l)=>{var _,m;n.save(),n.translate(a,r);const c=t(),f=o*c.cols+i,u=Ye(he);Lt(e.ground,c.layers.ground[f])(s,l,u)(n),(_=Ie(e.unit,c.layers.units[f]))==null||_.call(void 0,s,l,u)(n),(m=Ie(e.sky,c.layers.sky[f]))==null||m.call(void 0,s,l,u)(n),n.restore()},At=e=>Yt[ge[e.type].connector],Ht=(e,t)=>0,xt=(e,t)=>Et[qe(e,t)?"true":"false"][K(e,t)?"true":"false"][Ze(e,t)?"true":"false"][G(e,t)?"true":"false"],Ut=(e,t)=>t%5,It=(e,t)=>{const n=Vt[qe(e,t,H)?"true":"false"][K(e,t,H)?"true":"false"][Ze(e,t,H)?"true":"false"][G(e,t,H)?"true":"false"];if(n===0){if(!K(e,t+1,H))return 19;if(!G(e,t+1,H))return 18;if(!G(e,t-1,H))return 17;if(!K(e,t-1,H))return 16}return n},Wt=(e,t)=>K(e,t)||G(e,t)?1:0,Yt=[Ht,xt,Ut,It,Wt],Et={true:{true:{true:{true:5,false:6},false:{true:4,false:3}},false:{true:{true:8,false:2},false:{true:11,false:1}}},false:{true:{true:{true:7,false:9},false:{true:12,false:13}},false:{true:{true:10,false:14},false:{true:15,false:0}}}},Vt={true:{true:{true:{true:0,false:4},false:{true:3,false:12}},false:{true:{true:2,false:15},false:{true:5,false:8}}},false:{true:{true:{true:1,false:13},false:{true:14,false:9}},false:{true:{true:6,false:7},false:{true:10,false:11}}}},ne=(e,t)=>e[t].type,H=(e,t)=>ge[e[t].type].ocean,K=(e,t,n=ne)=>t-e.cols>=0&&n(e.layers.ground,t-e.cols)===n(e.layers.ground,t),G=(e,t,n=ne)=>t+e.cols<e.layers.ground.length&&n(e.layers.ground,t+e.cols)===n(e.layers.ground,t),qe=(e,t,n=ne)=>t%e.cols!==0&&n(e.layers.ground,t-1)===n(e.layers.ground,t),Ze=(e,t,n=ne)=>(t+1)%e.cols!==0&&n(e.layers.ground,t+1)===n(e.layers.ground,t);function zt(e){let t,n="loading...";return{c(){t=F("p"),t.textContent=n},l(o){t=L(o,"P",{"data-svelte-h":!0}),$e(t)!=="svelte-qeejp2"&&(t.textContent=n)},m(o,i){I(o,t,i)},p:N,i:N,o:N,d(o){o&&v(t)}}}function Bt(e){let t,n;return t=new Mt({props:{mini:e[3],interfacer:e[10],select:e[4],validTile:e[12],$$slots:{default:[Pt,({cellWidth:o,cellHeight:i,handleClick:a,handleHover:r,handleKeypress:s,handleOffset:l})=>({13:o,14:i,15:a,16:r,17:s,18:l}),({cellWidth:o,cellHeight:i,handleClick:a,handleHover:r,handleKeypress:s,handleOffset:l})=>(o?8192:0)|(i?16384:0)|(a?32768:0)|(r?65536:0)|(s?131072:0)|(l?262144:0)]},$$scope:{ctx:e}}}),{c(){_e(t.$$.fragment)},l(o){me(t.$$.fragment,o)},m(o,i){ue(t,o,i),n=!0},p(o,i){const a={};i&8&&(a.mini=o[3]),i&1024&&(a.interfacer=o[10]),i&16&&(a.select=o[4]),i&4096&&(a.validTile=o[12]),i&1042465&&(a.$$scope={dirty:i,ctx:o}),t.$set(a)},i(o){n||(W(t.$$.fragment,o),n=!0)},o(o){Y(t.$$.fragment,o),n=!1},d(o){pe(t,o)}}}function Pt(e){let t,n;return t=new Tt({props:{tileWidth:e[13],tileHeight:e[14],contentWidth:e[13]*e[0].cols,contentHeight:e[14]*e[0].rows,paint:We(e[11])(e[8]),requestRedraw:e[5],handleClick:e[15],handleHover:e[16],handleKeypress:e[17],handleOffset:e[18]}}),{c(){_e(t.$$.fragment)},l(o){me(t.$$.fragment,o)},m(o,i){ue(t,o,i),n=!0},p(o,i){const a={};i&8192&&(a.tileWidth=o[13]),i&16384&&(a.tileHeight=o[14]),i&8193&&(a.contentWidth=o[13]*o[0].cols),i&16385&&(a.contentHeight=o[14]*o[0].rows),i&2049&&(a.paint=We(o[11])(o[8])),i&32&&(a.requestRedraw=o[5]),i&32768&&(a.handleClick=o[15]),i&65536&&(a.handleHover=o[16]),i&131072&&(a.handleKeypress=o[17]),i&262144&&(a.handleOffset=o[18]),t.$set(a)},i(o){n||(W(t.$$.fragment,o),n=!0)},o(o){Y(t.$$.fragment,o),n=!1},d(o){pe(t,o)}}}function qt(e){let t,n,o,i;const a=[Bt,zt],r=[];function s(l,c){return l[2]?0:1}return t=s(e),n=r[t]=a[t](e),{c(){n.c(),o=ye()},l(l){n.l(l),o=ye()},m(l,c){r[t].m(l,c),I(l,o,c),i=!0},p(l,c){let f=t;t=s(l),t===f?r[t].p(l,c):(et(),Y(r[f],1,1,()=>{r[f]=null}),tt(),n=r[t],n?n.p(l,c):(n=r[t]=a[t](l),n.c()),W(n,1),n.m(o.parentNode,o))},i(l){i||(W(n),i=!0)},o(l){Y(n),i=!1},d(l){l&&v(o),r[t].d(l)}}}function Zt(e){let t,n,o,i;return document.title=rt,o=new Ft({props:{map:e[0],makeImage:e[1],select:e[4],$$slots:{default:[qt,({interfacer:a,renderData:r,select:s,validTile:l})=>({10:a,11:r,4:s,12:l}),({interfacer:a,renderData:r,select:s,validTile:l})=>(a?1024:0)|(r?2048:0)|(s?16:0)|(l?4096:0)]},$$scope:{ctx:e}}}),{c(){t=ce(),n=F("div"),_e(o.$$.fragment),this.h()},l(a){Je("svelte-115ss56",document.head).forEach(v),t=fe(a),n=L(a,"DIV",{class:!0});var s=x(n);me(o.$$.fragment,s),s.forEach(v),this.h()},h(){R(n,"class","flex gap-2 border-4 border-black h-full bg-stone-400")},m(a,r){I(a,t,r),I(a,n,r),ue(o,n,null),i=!0},p(a,[r]){const s={};r&1&&(s.map=a[0]),r&2&&(s.makeImage=a[1]),r&16&&(s.select=a[4]),r&531517&&(s.$$scope={dirty:r,ctx:a}),o.$set(s)},i(a){i||(W(o.$$.fragment,a),i=!0)},o(a){Y(o.$$.fragment,a),i=!1},d(a){a&&(v(t),v(n)),pe(o)}}}const re=800;function Nt(e,t,n){let o;se(e,V,m=>n(7,o=m));let{pause:i=!1}=t,{map:a}=t,{makeImage:r}=t,{loaded:s}=t,{select:l}=t,{mini:c=!1}=t,f=0;const u=()=>{if(i){Z(V,o=null,o);return}he.update(m=>(m+1)%1e5),Z(V,o=setTimeout(u,re),o)};le(()=>{!i&&!o&&Z(V,o=setTimeout(u,re),o)}),Qe(()=>{o&&clearTimeout(o),Z(V,o=null,o)});const _=()=>a;return e.$$set=m=>{"pause"in m&&n(6,i=m.pause),"map"in m&&n(0,a=m.map),"makeImage"in m&&n(1,r=m.makeImage),"loaded"in m&&n(2,s=m.loaded),"select"in m&&n(4,l=m.select),"mini"in m&&n(3,c=m.mini)},e.$$.update=()=>{e.$$.dirty&1&&(a.layers.ground.map((m,d)=>m.state=At(m)(a,d)),n(5,f=performance.now())),e.$$.dirty&192&&!i&&!o&&Z(V,o=setTimeout(u,re),o)},[a,r,s,c,l,f,i,o,_]}class $t extends Q{constructor(t){super(),$(this,t,Nt,Zt,J,{pause:6,map:0,makeImage:1,loaded:2,select:4,mini:3})}}const en=B(null),tn=B(!1);export{$t as M,Qt as P,Dt as a,rt as b,Jt as c,tn as l,en as m,ve as s,ge as t,it as u};
