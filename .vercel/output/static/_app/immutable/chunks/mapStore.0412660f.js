import{T as E,s as N,f as F,g as L,h as A,d as O,j as b,i as P,y as I,C as R,v as D,X as k,r as Se,W as Ze,E as Ke,o as ae,Y as C,p as ye,F as re,a as oe,c as ie,I as le,J as se,K as ce,G as Ne,N as qe,e as ve}from"./scheduler.4123ea5a.js";import{S as q,i as G,a as H,t as x,b as fe,d as _e,m as ue,e as me,g as Ge,c as je}from"./index.ccd460da.js";import{w as Z}from"./index.0e1d7533.js";const Je=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,Te=Z({ground:{},units:{},sky:{}}),K=Z({ground:{},units:{},sky:{}}),pe=(e,t)=>n=>o=>Object.entries(t.reduce((i,a,l)=>(i[l]=a,i),{})).filter((i,a)=>o.indexOf(a)!==-1).reduce((i,[a,l])=>{const r=parseInt(a),s=E(Te)[e][r];return s?l.sprite=s:n(l.url)(_=>{Te.update(c=>(c[e][r]=_,c)),l.sprite=_}),i[r]=l,i},{}),ge=[{url:"game/play/terrain/plains.png",frames:1,xOffset:0,yOffset:0,connector:2,name:"Plains",description:"Basic terrain",details:"dirty",ocean:!1,protection:.1,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/hills.png",frames:1,xOffset:0,yOffset:0,connector:2,name:"Hills",description:"Gives ranged units an extended range",details:"rough",ocean:!1,protection:.2,damage:0,height:20,drag:2,modifiers:["CURMODS.Properties.Extra_Sight"]},{url:"game/play/terrain/forest.png",frames:1,xOffset:0,yOffset:0,connector:2,name:"Forest",description:"Gives defense boost",details:"rough",ocean:!1,protection:.2,damage:0,height:5,drag:2,modifiers:[]},{url:"game/play/terrain/mountain.png",frames:1,xOffset:0,yOffset:0,connector:2,name:"Mountain",description:"Hard to traverse but gives strong defense",details:"rugged",ocean:!1,protection:.4,damage:0,height:50,drag:2,modifiers:["CURMODS.Properties.Extra_Sight"]},{url:"game/play/terrain/road.png",frames:1,xOffset:0,yOffset:0,connector:1,name:"Road",description:"Easy to traverse but provides no defense",details:"clean",ocean:!1,protection:0,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/canyon.png",frames:1,xOffset:0,yOffset:0,connector:1,name:"Canyon",description:"Dips down, but ranged units cannot target here",details:"slippery",ocean:!1,protection:.3,damage:0,height:-10,drag:1,modifiers:["CURMODS.Properties.Trench"]},{url:"game/play/terrain/wasteland.png",frames:1,xOffset:0,yOffset:0,connector:0,name:"Wasteland",description:"Provides lots of defense, but costs health to rest on",details:"dirty",ocean:!1,protection:.5,damage:10,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/volcano.png",frames:1,xOffset:0,yOffset:34,connector:0,name:"Volcano",description:"Impassable",details:"impassable",ocean:!1,protection:0,damage:0,height:100,drag:100,modifiers:[]},{url:"game/play/terrain/enriched-ore-deposit.png",frames:1,xOffset:0,yOffset:0,connector:0,name:"Enriched Ore Deposit",description:"Can be mined for money",details:"pot-holes",ocean:!1,protection:0,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/ore-deposit.png",frames:1,xOffset:0,yOffset:0,connector:0,name:"Ore Deposit",description:"Can be mined for money",details:"pot-holes",ocean:!1,protection:0,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/depleted-ore-deposit.png",frames:1,xOffset:0,yOffset:0,connector:0,name:"Depleted Ore Deposit",description:"Can be mined for money",details:"pot-holes",ocean:!1,protection:0,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/sea.png",frames:3,xOffset:0,yOffset:0,connector:3,name:"Sea",description:"Basic sea terrain",details:"clean",ocean:!0,protection:0,damage:0,height:0,drag:1,modifiers:[]},{url:"game/play/terrain/reef.png",frames:3,xOffset:0,yOffset:0,connector:0,name:"Reef",description:"Hard to traverse sea terrain",details:"dirty",ocean:!0,protection:.1,damage:0,height:10,drag:2,modifiers:[]},{url:"game/play/terrain/archipelago.png",frames:3,xOffset:0,yOffset:0,connector:0,name:"Archipelago",description:"Rough sea terrain",details:"rough",ocean:!0,protection:.2,damage:0,height:20,drag:2,modifiers:[]},{url:"game/play/terrain/rock-formation.png",frames:3,xOffset:0,yOffset:0,connector:0,name:"Rock Formation",description:"Rocky sea terrain",details:"rugged",ocean:!0,protection:.7,damage:20,height:0,drag:2,modifiers:[]},{url:"game/play/terrain/shore.png",frames:3,xOffset:0,yOffset:0,connector:3,name:"Shore",description:"An easy access to the sea",details:"rough",ocean:!0,protection:0,damage:0,height:0,drag:1,modifiers:["CURMODS.Properties.Port"]},{url:"game/play/terrain/bridge.png",frames:1,xOffset:0,yOffset:0,connector:4,name:"Bridge",description:"Connects two islands, but provides no defense",details:"clean",ocean:!1,protection:0,damage:0,height:10,drag:1,modifiers:[]},{url:"game/play/terrain/high-bridge.png",frames:1,xOffset:0,yOffset:0,connector:4,name:"High Bridge",description:"Connects two islands, and allows ships to pass, but provides no defense",details:"clean",ocean:!1,protection:0,damage:0,height:20,drag:1,modifiers:[]}],Qe=pe("ground",ge),v=[1,1],$e=[{url:"game/play/units/idle/strike-commando.png",frames:4,yOffset:0,xOffset:0,name:"Strike Commando",description:"Basic land unit",type:0,maxHealth:40,armor:0,power:20,weaponType:0,movement:3,movementType:0,range:v,sight:2,cost:75,actable:!0,modifiers:["CURMODS.Start_Turn.Capture","CURMODS.Move.Tracking","CURMODS.Self_Action.Transport","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('light gun')",moveSFX:"SFXs.Retrieve('footstep')"},{url:"game/play/units/idle/heavy-commando.png",frames:4,yOffset:0,xOffset:0,name:"Heavy Commando",description:"Basic land unit",type:0,maxHealth:40,armor:0,power:35,weaponType:2,movement:3,movementType:0,range:v,sight:2,cost:100,actable:!0,modifiers:["CURMODS.Start_Turn.Capture","CURMODS.Move.Tracking","CURMODS.Self_Action.Transport","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('footstep')"},{url:"game/play/units/idle/flak-tank.png",frames:4,yOffset:60,xOffset:0,name:"Flak Tank",description:"Very effective against air units",type:0,maxHealth:70,armor:1,power:17,weaponType:0,movement:6,movementType:2,range:v,sight:3,cost:240,actable:!0,modifiers:["CURMODS.Can_Attack.Air_Raid","CURMODS.Damage.Flak","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('machine gun')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/scorpion-tank.png",frames:4,yOffset:0,xOffset:0,name:"Scorpion Tank",description:"Basic tank unit",type:0,maxHealth:70,armor:1,power:35,weaponType:1,movement:6,movementType:2,range:v,sight:3,cost:270,actable:!0,modifiers:["CURMODS.Damage.Fast_Attack","CURMODS.Self_Action.Repairable","CURMODS.Can_Attack.Bombard"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/lance-tank.png",frames:4,yOffset:0,xOffset:0,name:"Lance Tank",description:"Can hit space directly behind enemy",type:0,maxHealth:70,armor:1,power:35,weaponType:1,movement:6,movementType:2,range:v,sight:3,cost:270,actable:!0,modifiers:["CURMODS.Attack.Lance","CURMODS.Self_Action.Repairable","CURMODS.Can_Attack.Bombard"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/spider-tank.png",frames:4,yOffset:0,xOffset:0,name:"Spider Tank",description:"Can climb mountains",type:0,maxHealth:40,armor:1,power:40,weaponType:1,movement:4,movementType:0,range:v,sight:3,cost:250,actable:!0,modifiers:["CURMODS.Attack.Stun","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('light gun')",moveSFX:"SFXs.Retrieve('footstep')"},{url:"game/play/units/idle/stealth-tank.png",frames:4,yOffset:0,xOffset:0,name:"Stealth Tank",description:"Can hide itself",type:0,maxHealth:40,armor:1,power:30,weaponType:0,movement:5,movementType:2,range:v,sight:3,cost:340,actable:!0,modifiers:["CURMODS.End_Turn.Cloak","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('distance gun')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/annihilator-tank.png",frames:4,yOffset:60,xOffset:0,name:"Annihilator Tank",description:"Massive tank",type:0,maxHealth:140,armor:2,power:70,weaponType:2,movement:4,movementType:2,range:v,sight:3,cost:525,actable:!0,modifiers:["CURMODS.Damage.Slow_Attack","CURMODS.Self_Action.Repairable","CURMODS.Can_Attack.Bombard"],attackSFX:"SFXs.Retrieve('explosion')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/mortar-truck.png",frames:4,yOffset:60,xOffset:0,name:"Mortar Truck",description:"Heavy distanced attack but with short range",type:0,maxHealth:50,armor:0,power:48,weaponType:1,movement:5,movementType:1,range:[2,3],sight:3,cost:285,actable:!0,modifiers:["CURMODS.Can_Attack.Counter_Range","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/rocket-truck.png",frames:4,yOffset:60,xOffset:0,name:"Rocket Truck",description:"Weaker distanced attack but with long range",type:0,maxHealth:40,armor:0,power:40,weaponType:2,movement:6,movementType:1,range:[3,5],sight:4,cost:470,actable:!0,modifiers:["CURMODS.Can_Attack.Counter_Range","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('explosion')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/jammer-truck.png",frames:4,yOffset:60,xOffset:0,name:"Jammer Truck",description:"Stops air units from entering jammed area and uncloaks hidden units",type:0,maxHealth:50,armor:0,power:0,weaponType:-1,movement:5,movementType:1,range:[],sight:2,cost:300,actable:!0,modifiers:["CURMODS.Move.Radar","CURMODS.Idle.Jamming","CURMODS.Self_Action.Repairable"],attackSFX:null,moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/warmachine.png",frames:4,yOffset:60,xOffset:0,name:"Warmachine",description:"Creates other units",type:0,maxHealth:75,armor:1,power:60,weaponType:2,movement:3,movementType:2,range:[2,3],sight:3,cost:525,Cash:2e3,actable:!0,modifiers:["CURMODS.Self_Action.Miner","CURMODS.Self_Action.Builder","CURMODS.Self_Action.Repairable","CURMODS.Death.Insta_Lose"],attackSFX:"SFXs.Retrieve('explosion')",moveSFX:"SFXs.Retrieve('car engine')"},{url:"game/play/units/idle/intrepid.png",frames:4,yOffset:0,xOffset:0,name:"Intrepid",description:"Can capture sea buildings",type:2,maxHealth:50,armor:0,power:15,weaponType:0,movement:6,movementType:6,rlow:!1,sange:v,cost:200,actable:!0,modifiers:["CURMODS.Start_Turn.Capture","CURMODS.Move.Tracking","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('machine gun')",moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/corvette.png",frames:4,yOffset:60,xOffset:0,name:"Corvette",description:"Basic sea unit",type:2,maxHealth:90,armor:1,power:45,weaponType:1,movement:5,movementType:8,range:v,sight:4,cost:500,actable:!0,modifiers:["CURMODS.Can_Attack.Ground_Assult","CURMODS.Damage.Fast_Attack"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/hunter-support.png",frames:4,yOffset:60,xOffset:0,name:"Hunter Support",description:"Can attack air units",type:2,maxHealth:90,armor:1,power:17,weaponType:0,movement:5,movementType:6,range:v,sight:4,cost:450,actable:!0,modifiers:["CURMODS.Can_Attack.Air_Raid","CURMODS.Damage.Flak","CURMODS.Move.Tracking","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('machine gun')",moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/u-boat.png",frames:4,yOffset:60,xOffset:0,name:"U-Boat",description:"Can hide underwater",type:2,maxHealth:25,armor:0,power:35,weaponType:2,movement:4,movementType:7,range:v,sight:4,cost:475,actable:!0,modifiers:["CURMODS.End_Turn.Cloak","CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/raptor-fighter.png",frames:4,yOffset:60,xOffset:0,name:"Raptor Fighter",description:"Basic air unit",type:1,maxHealth:50,armor:0,power:25,weaponType:0,movement:8,movementType:4,range:v,sight:5,cost:235,actable:!0,modifiers:["CURMODS.Can_Attack.Air_Raid","CURMODS.Self_Action.Irreparable"],attackSFX:"SFXs.Retrieve('machine gun')",moveSFX:"SFXs.Retrieve('jet')"},{url:"game/play/units/idle/condor-bomber.png",frames:4,yOffset:60,xOffset:0,name:"Condor Bomber",description:"Drops bombs of massive damage",type:1,maxHealth:40,armor:1,power:70,weaponType:2,movement:4,movementType:4,range:v,sight:3,cost:600,actable:!0,modifiers:["CURMODS.Self_Action.Repairable","CURMODS.Can_Attack.Bombard"],attackSFX:"SFXs.Retrieve('explosion')",moveSFX:"SFXs.Retrieve('air')"},{url:"game/play/units/idle/vulture-drone.png",frames:4,yOffset:60,xOffset:0,name:"Vulture Drone",description:"Can move again if attack kills",type:1,maxHealth:55,armor:1,power:30,weaponType:1,movement:5,movementType:3,range:v,sight:5,cost:550,actable:!0,modifiers:["CURMODS.End_Turn.Vulture","CURMODS.Self_Action.Repairable","CURMODS.Can_Attack.Bombard"],attackSFX:"SFXs.Retrieve('distance gun')",moveSFX:"SFXs.Retrieve('jet')"},{url:"game/play/units/idle/turret.png",frames:4,yOffset:60,xOffset:0,name:"Turret",description:"Basic turret unit",type:0,maxHealth:100,armor:1,power:40,weaponType:1,movement:0,movementType:9,range:[2,5],sight:5,cost:0,actable:!0,modifiers:["CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('distance gun')",moveSFX:"SFXs.Retrieve('quite')"},{url:"game/play/units/idle/blockade.png",frames:4,yOffset:0,xOffset:0,name:"Blockade",description:"Cannot move or attack, but enemies cannot cross",type:0,maxHealth:70,armor:1,power:0,weaponType:0,movement:0,movementType:9,range:[0,0],sight:0,cost:0,actable:!1,modifiers:["CURMODS.Self_Action.Irreparable"],attackSFX:null,moveSFX:"SFXs.Retrieve('quite')"},{url:"game/play/units/idle/battle-cruiser.png",frames:4,yOffset:60,xOffset:0,name:"Battle Cruiser",description:"Can attack from the farthest distance in the game",type:2,maxHealth:140,armor:2,power:55,weaponType:2,movement:4,movementType:8,range:[2,6],sight:6,cost:800,actable:!0,modifiers:["CURMODS.Self_Action.Repairable"],attackSFX:"SFXs.Retrieve('big gun')",moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/leviathan.png",frames:4,yOffset:60,xOffset:0,name:"Leviathan",description:"Can ship across water",type:2,maxHealth:60,armor:1,power:0,weaponType:2,movement:4,movementType:7,range:v,sight:2,cost:0,actable:!0,modifiers:["CURMODS.Self_Action.Land","CURMODS.Self_Action.Repairable"],attackSFX:null,moveSFX:"SFXs.Retrieve('boat')"},{url:"game/play/units/idle/transporter.png",frames:4,yOffset:60,xOffset:0,name:"Transporter",description:"Can transport a non-air unit through the air",type:1,maxHealth:50,armor:0,power:0,weaponType:0,movement:6,movementType:3,range:[0,0],sight:3,cost:0,actable:!0,modifiers:["CURMODS.Self_Action.Land","CURMODS.Self_Action.Repairable"],attackSFX:null,moveSFX:"SFXs.Retrieve('air')"}],et=pe("units",$e),Kt=e=>{const[t,n]=(o=>{let i=0,a=0;const l=r=>{r(),o(a===i)};return[()=>l(()=>i++),r=>()=>l(()=>{a++,r()})]})(e);return o=>i=>{t(),fetch(o).then(a=>a.blob()).then(a=>{const l=new Image;l.src=URL.createObjectURL(a),l.onload=n(()=>i(l))}).catch(a=>{console.error("Error fetching image:",a)})}},Nt=e=>lt[ge[e.type].connector],tt=(e,t)=>0,nt=(e,t)=>st[Ue(e,t)?"true":"false"][z(e,t)?"true":"false"][Ie(e,t)?"true":"false"][B(e,t)?"true":"false"],ot=(e,t)=>Math.floor(Math.random()*5),it={true:{true:{true:{true:0,false:4},false:{true:3,false:12}},false:{true:{true:2,false:15},false:{true:5,false:8}}},false:{true:{true:{true:1,false:13},false:{true:14,false:9}},false:{true:{true:6,false:7},false:{true:10,false:11}}}},at=(e,t)=>{const n=it[Ue(e,t)(w)?"true":"false"][z(e,t)(w)?"true":"false"][Ie(e,t)(w)?"true":"false"][B(e,t)(w)?"true":"false"];if(n===0){if(!z(e,t+1)(w))return 19;if(!B(e,t+1)(w))return 18;if(!B(e,t-1)(w))return 17;if(!z(e,t-1)(w))return 16}return n},rt=(e,t)=>z(e,t)||B(e,t)?1:0,lt=[tt,nt,ot,at,rt],st={true:{true:{true:{true:5,false:6},false:{true:4,false:3}},false:{true:{true:8,false:2},false:{true:11,false:1}}},false:{true:{true:{true:7,false:9},false:{true:12,false:13}},false:{true:{true:10,false:14},false:{true:15,false:0}}}},ct=(e,t)=>e[t].type,w=(e,t)=>ge[e[t].type].ocean,z=(e,t)=>(n=ct)=>t-e.rows>=0&&n(e.layers.ground,t-e.rows)===n(e.layers.ground,t),B=(e,t)=>n=>t+e.rows<e.layers.ground.length&&n(e.layers.ground,t+e.rows)===n(e.layers.ground,t),Ue=(e,t)=>n=>t%e.rows!==0&&n(e.layers.ground,t-1)===n(e.layers.ground,t),Ie=(e,t)=>n=>(t+1)%e.rows!==0&&n(e.layers.ground,t+1)===n(e.layers.ground,t),ft="ThunderLite Local",_t=()=>({__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__tileWidth:0,__tileHeight:0,setup:function({clientWidth:e,clientHeight:t,contentWidth:n,contentHeight:o,tileWidth:i,tileHeight:a}){this.__clientWidth=e,this.__clientHeight=t,this.__contentWidth=n,this.__contentHeight=o,this.__tileWidth=i,this.__tileHeight=a},render:function(e,t){return(n,o,i)=>{e(n,o,i);const a=this.__clientHeight,l=this.__clientWidth,r=this.__tileHeight*i,s=this.__tileWidth*i,_=Math.max(Math.floor(o/r),0),c=Math.max(Math.floor(n/s),0),f=this.__contentHeight*i/r,g=this.__contentWidth*i/s,m=o>=0?-o%r:-o,d=n>=0?-n%s:-n;let h=Math.floor(a/r);o%r>0&&(h+=1),m+h*r<a&&(h+=1);let u=Math.floor(l/s);n%s>0&&(u+=1),d+u*s<l&&(u+=1),h=Math.min(h,f-_),u=Math.min(u,g-c);let S=m,y=d;for(let T=_;T<h+_;T++){for(let Y=c;Y<u+c;Y++)t(T,Y,y,S,s,r,i),y+=s;y=d,S+=r}}}}),te=60,ne=1e3;let X=[],ut=1;const U={requestAnimationFrame:function(){const e=typeof window<"u"?window.requestAnimationFrame:()=>{};let t=!!e;if(e&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(e.toString())&&(t=!1),t)return function(r){e(r)};const n=60;let o={},i=1,a=null,l=performance.now();return function(r){const s=i++;return o[s]=r,a===null&&(a=setInterval(function(){const _=performance.now(),c=o;o={};for(const f in c)c[f]&&(c[f](_),l=_);_-l>2500&&a&&(clearInterval(a),a=null)},1e3/n)),s}}(),stop:function(e){const t=X[e]!==null;return t&&(X[e]=null),t},isRunning:function(e){return X[e]!=null},start:function(e,t,n,o,i,a){const l=performance.now();let r=l,s=0,_=0;const c=ut++;if(c%20===0){const m=[];for(const d in X)m[d]=!0;X=m}const f=m=>d=>{if(!X[c]||t&&!t(c)){X[c]=null,n&&n(te-_/((d-l)/ne),c);return}if(m){const u=Math.round((d-r)/(ne/te))-1;for(let S=0;S<Math.min(u,4);S++)g(),_++}o&&(s=(d-l)/o,s>1&&(s=1));const h=i?i(s):s;(e(h,d,m)===!1||s===1)&&m?(X[c]=null,n&&n(te-_/((d-l)/ne),c)):m&&(r=d,this.requestAnimationFrame(f(!0)))},g=()=>{f(!1)(performance.now())};return X[c]=!0,this.requestAnimationFrame(f(!0)),c}},mt=function(e){return Math.pow(e-1,3)+1},pt=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},gt=function(){const e={__isSingleTouch:!1,__isTracking:!1,__didDecelerationComplete:!1,__isGesturing:!1,__isDragging:!1,__isDecelerating:0,__isAnimating:0,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:!1,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:[],__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,setPosition:function(t,n){},setDimensions:function(t,n,o,i){},__computeScrollMax:function(t){},scrollTo:function(t,n,o,i){},setSnapSize:function(t,n){},activatePullToRefresh:function(t,n,o,i){},triggerPullToRefresh:()=>{},finishPullToRefresh:()=>{},getValues:function(){return{left:0,top:0,zoom:0}},getScrollMax:function(){return{left:0,top:0}},zoomTo:function(t,n,o,i,a){},options:{scrollingX:void 0,scrollingY:void 0,animating:void 0,animationDuration:void 0,bouncing:void 0,locking:void 0,paging:void 0,snapping:void 0,zooming:void 0,minZoom:void 0,maxZoom:void 0,speedMultiplier:void 0,scrollingComplete:void 0,penetrationDeceleration:void 0,penetrationAcceleration:void 0},__zoomComplete:null,__publish:function(t,n,o,i){},zoomBy:function(t,n,o,i,a){},scrollBy:function(t,n,o){},doMouseZoom:function(t,n,o,i){},doTouchStart:function(t,n){},__interruptedAnimation:!1,__initialTouchLeft:0,__initialTouchTop:0,__zoomLevelStart:0,__lastScale:0,__enableScrollX:!1,__enableScrollY:!1,doTouchMove:function(t,n,o){},doTouchEnd:function(t){},__startDeceleration:()=>{},customRender:function(t,n,o){},__stepThroughDeceleration:function(t){}};return e.setDimensions=function(t,n,o,i){t===+t&&(e.__clientWidth=t),n===+n&&(e.__clientHeight=n),o===+o&&(e.__contentWidth=o),i===+i&&(e.__contentHeight=i),e.__computeScrollMax(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},e.setPosition=function(t,n){e.__clientLeft=t||0,e.__clientTop=n||0},e.setSnapSize=function(t,n){e.__snapWidth=t,e.__snapHeight=n},e.activatePullToRefresh=function(t,n,o,i){e.__refreshHeight=t,e.__refreshActivate=n,e.__refreshDeactivate=o,e.__refreshStart=i},e.triggerPullToRefresh=function(){e.__publish(e.__scrollLeft,e.__refreshHeight?-e.__refreshHeight:0,e.__zoomLevel,!0),e.__refreshStart&&e.__refreshStart()},e.finishPullToRefresh=function(){e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},e.getValues=function(){return{left:e.__scrollLeft,top:e.__scrollTop,zoom:e.__zoomLevel}},e.getScrollMax=function(){return{left:e.__maxScrollLeft,top:e.__maxScrollTop}},e.zoomTo=function(t,n,o,i,a){if(!e.options.zooming)return;a&&(e.__zoomComplete=a),e.__isDecelerating&&(U.stop(e.__isDecelerating),e.__isDecelerating=0);const l=e.__zoomLevel;o==null&&(o=e.__clientWidth/2),i==null&&(i=e.__clientHeight/2),t=Math.max(Math.min(t,e.options.maxZoom??3),e.options.minZoom??.5),e.__computeScrollMax(t);let r=(o+e.__scrollLeft)*t/l-o,s=(i+e.__scrollTop)*t/l-i;r>e.__maxScrollLeft?r=e.__maxScrollLeft:r<0&&(r=0),s>e.__maxScrollTop?s=e.__maxScrollTop:s<0&&(s=0),e.__publish(r,s,t,n)},e.zoomBy=function(t,n,o,i,a){e.zoomTo(e.__zoomLevel*t,n,o,i,a)},e.scrollTo=function(t,n,o,i){if(e.__isDecelerating&&(U.stop(e.__isDecelerating),e.__isDecelerating=0),i&&i!==e.__zoomLevel){if(!e.options.zooming)return;t*=i,n*=i,e.__computeScrollMax(i)}else i=e.__zoomLevel;e.options.scrollingX?e.options.paging?t=Math.round(t/e.__clientWidth)*e.__clientWidth:e.options.snapping&&(t=Math.round(t/e.__snapWidth)*e.__snapWidth):t=e.__scrollLeft,e.options.scrollingY?e.options.paging?n=Math.round(n/e.__clientHeight)*e.__clientHeight:e.options.snapping&&(n=Math.round(n/e.__snapHeight)*e.__snapHeight):n=e.__scrollTop,t=Math.max(Math.min(e.__maxScrollLeft,t),0),n=Math.max(Math.min(e.__maxScrollTop,n),0),t===e.__scrollLeft&&n===e.__scrollTop&&(o=!1),e.__isTracking||e.__publish(t,n,i,o)},e.scrollBy=function(t,n,o){const i=e.__isAnimating?e.__scheduledLeft:e.__scrollLeft,a=e.__isAnimating?e.__scheduledTop:e.__scrollTop;e.scrollTo(i+(t||0),a+(n||0),o)},e.doMouseZoom=function(t,n,o,i){const a=t>0?.97:1.03;e.zoomTo(e.__zoomLevel*a,!1,o-e.__clientLeft,i-e.__clientTop)},e.doTouchStart=function(t,n){if(t.length==null)throw new Error("Invalid touch list: "+t);if(typeof n!="number")throw new Error("Invalid timestamp value: "+n);e.__interruptedAnimation=!0,e.__isDecelerating&&(U.stop(e.__isDecelerating),e.__isDecelerating=0,e.__interruptedAnimation=!0),e.__isAnimating&&(U.stop(e.__isAnimating),e.__isAnimating=0,e.__interruptedAnimation=!0);let o,i;const a=t.length===1;a?(o=t[0].pageX,i=t[0].pageY):(o=Math.abs(t[0].pageX+t[1].pageX)/2,i=Math.abs(t[0].pageY+t[1].pageY)/2),e.__initialTouchLeft=o,e.__initialTouchTop=i,e.__zoomLevelStart=e.__zoomLevel,e.__lastTouchLeft=o,e.__lastTouchTop=i,e.__lastTouchMove=n,e.__lastScale=1,e.__enableScrollX=!a&&e.options.scrollingX||!1,e.__enableScrollY=!a&&e.options.scrollingY||!1,e.__isTracking=!0,e.__didDecelerationComplete=!1,e.__isDragging=!a,e.__isSingleTouch=a,e.__positions=[]},e.doTouchMove=function(t,n,o){if(t.length==null)throw new Error("Invalid touch list: "+t);if(typeof n!="number")throw new Error("Invalid timestamp value: "+n);if(!e.__isTracking)return!1;let i,a;t.length===2?(i=Math.abs(t[0].pageX+t[1].pageX)/2,a=Math.abs(t[0].pageY+t[1].pageY)/2):(i=t[0].pageX,a=t[0].pageY);const l=e.__positions;if(e.__isDragging&&e.__lastTouchLeft&&e.__lastTouchTop){const r=i-e.__lastTouchLeft,s=a-e.__lastTouchTop;let _=e.__scrollLeft,c=e.__scrollTop,f=e.__zoomLevel;if(o!=null&&e.options.zooming){const g=f;if(f=f/e.__lastScale*o,f=Math.max(Math.min(f,e.options.maxZoom??3),e.options.minZoom??.5),g!==f){const m=i-e.__clientLeft,d=a-e.__clientTop;_=(m+_)*f/g-m,c=(d+c)*f/g-d,e.__computeScrollMax(f)}}if(e.__enableScrollX&&e.options.speedMultiplier){_-=r*e.options.speedMultiplier;const g=e.__maxScrollLeft;(_>g||_<0)&&(e.options.bouncing?_+=r/2*e.options.speedMultiplier:_>g?_=g:_=0)}if(e.__enableScrollY&&e.options.speedMultiplier){c-=s*e.options.speedMultiplier;const g=e.__maxScrollTop;(c>g||c<0)&&(e.options.bouncing?(c+=s/2*e.options.speedMultiplier,!e.__enableScrollX&&e.__refreshHeight!=null&&(!e.__refreshActive&&c<=-e.__refreshHeight?(e.__refreshActive=!0,e.__refreshActivate&&e.__refreshActivate()):e.__refreshActive&&c>-e.__refreshHeight&&(e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate()))):c>g?c=g:c=0)}l&&l.length>60&&l.splice(0,30),l==null||l.push(_,c,n),e.__publish(_,c,f)}else{const r=e.options.locking?3:0,s=5,_=Math.abs(i-e.__initialTouchLeft),c=Math.abs(a-e.__initialTouchTop);e.__enableScrollX=e.options.scrollingX&&_>=r,e.__enableScrollY=e.options.scrollingY&&c>=r,l==null||l.push(e.__scrollLeft,e.__scrollTop,n),e.__isDragging=(e.__enableScrollX||e.__enableScrollY)&&(_>=s||c>=s),e.__isDragging&&(e.__interruptedAnimation=!1)}return e.__lastTouchLeft=i,e.__lastTouchTop=a,e.__lastTouchMove=n,o&&(e.__lastScale=o),!0},e.doTouchEnd=function(t){if(typeof t!="number")throw new Error("Invalid timestamp value: "+t);if(e.__isTracking){if(e.__isTracking=!1,e.__isDragging)if(e.__isDragging=!1,e.__isSingleTouch&&e.options.animating&&e.__lastTouchMove&&t-e.__lastTouchMove<=100){const n=e.__positions,o=n.length-1;let i=o;for(let a=o;a>0&&n[a]>e.__lastTouchMove-100;a-=3)i=a;if(i!==o){const a=n[o]-n[i],l=e.__scrollLeft-n[i-2],r=e.__scrollTop-n[i-1];e.__decelerationVelocityX=l/a*(1e3/60),e.__decelerationVelocityY=r/a*(1e3/60);const s=e.options.paging||e.options.snapping?4:1;Math.abs(e.__decelerationVelocityX)>s||Math.abs(e.__decelerationVelocityY)>s?e.__refreshActive||e.__startDeceleration():e.options.scrollingComplete&&e.options.scrollingComplete()}else e.options.scrollingComplete&&e.options.scrollingComplete()}else e.__lastTouchMove&&t-e.__lastTouchMove>100&&e.options.scrollingComplete&&e.options.scrollingComplete();e.__isDecelerating||(e.__refreshActive&&e.__refreshStart?(e.__publish(e.__scrollLeft,e.__refreshHeight?-e.__refreshHeight:0,e.__zoomLevel,!0),e.__refreshStart&&e.__refreshStart()):((e.__interruptedAnimation||e.__isDragging)&&e.options.scrollingComplete&&e.options.scrollingComplete(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0,e.__zoomLevel),e.__refreshActive&&(e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate()))),e.__positions=[]}},e.__publish=function(t,n,o,i){const a=e.__isAnimating;if(a&&(U.stop(a),e.__isAnimating=0),i&&e.options.animating){e.__scheduledLeft=t,e.__scheduledTop=n,e.__scheduledZoom=o;const l=e.__scrollLeft,r=e.__scrollTop,s=e.__zoomLevel,_=t-l,c=n-r,f=o-s,g=function(h,u,S){S&&(e.__scrollLeft=l+_*h,e.__scrollTop=r+c*h,e.__zoomLevel=s+f*h,e.customRender&&e.customRender(e.__scrollLeft,e.__scrollTop,e.__zoomLevel))},m=function(h){return e.__isAnimating===h},d=function(h,u){h===e.__isAnimating&&(e.__isAnimating=0),(e.__didDecelerationComplete||u)&&e.options.scrollingComplete&&e.options.scrollingComplete(),e.options.zooming&&(e.__computeScrollMax(),e.__zoomComplete&&(e.__zoomComplete(),e.__zoomComplete=null))};e.__isAnimating=U.start(g,m,d,e.options.animationDuration??0,a?mt:pt)}else e.__scheduledLeft=e.__scrollLeft=t,e.__scheduledTop=e.__scrollTop=n,e.__scheduledZoom=e.__zoomLevel=o,e.customRender&&e.customRender(t,n,o),e.options.zooming&&(e.__computeScrollMax(),e.__zoomComplete&&(e.__zoomComplete(),e.__zoomComplete=null))},e.__computeScrollMax=function(t){t==null&&(t=e.__zoomLevel),e.__maxScrollLeft=Math.max(e.__contentWidth*t-e.__clientWidth,0),e.__maxScrollTop=Math.max(e.__contentHeight*t-e.__clientHeight,0)},e.__startDeceleration=function(){if(e.options.paging){const a=Math.max(Math.min(e.__scrollLeft,e.__maxScrollLeft),0),l=Math.max(Math.min(e.__scrollTop,e.__maxScrollTop),0),r=e.__clientWidth,s=e.__clientHeight;e.__minDecelerationScrollLeft=Math.floor(a/r)*r,e.__minDecelerationScrollTop=Math.floor(l/s)*s,e.__maxDecelerationScrollLeft=Math.ceil(a/r)*r,e.__maxDecelerationScrollTop=Math.ceil(l/s)*s}else e.__minDecelerationScrollLeft=0,e.__minDecelerationScrollTop=0,e.__maxDecelerationScrollLeft=e.__maxScrollLeft,e.__maxDecelerationScrollTop=e.__maxScrollTop;const t=function(a,l,r){e.__stepThroughDeceleration(r)},n=e.options.snapping?4:.001,o=function(){if(!e.__decelerationVelocityX||!e.__decelerationVelocityY)return!1;const a=Math.abs(e.__decelerationVelocityX)>=n||Math.abs(e.__decelerationVelocityY)>=n;return a||(e.__didDecelerationComplete=!0),a},i=function(){e.__isDecelerating=0,e.__didDecelerationComplete&&e.options.scrollingComplete&&e.options.scrollingComplete(),e.scrollTo(e.__scrollLeft,e.__scrollTop,e.options.snapping)};e.__isDecelerating=U.start(t,o,i)},e.__stepThroughDeceleration=function(t){if(!e.__decelerationVelocityY||!e.__decelerationVelocityX)return;let n=e.__scrollLeft+e.__decelerationVelocityX,o=e.__scrollTop+e.__decelerationVelocityY;if(!e.options.bouncing){const i=Math.max(Math.min(e.__maxDecelerationScrollLeft??n,n),e.__minDecelerationScrollLeft??n);i!==n&&(n=i,e.__decelerationVelocityX=0);const a=Math.max(Math.min(e.__maxDecelerationScrollTop??o,o),e.__minDecelerationScrollTop??o);a!==o&&(o=a,e.__decelerationVelocityY=0)}if(t?e.__publish(n,o,e.__zoomLevel):(e.__scrollLeft=n,e.__scrollTop=o),e.options.paging||(e.__decelerationVelocityX*=.95,e.__decelerationVelocityY*=.95),e.options.bouncing){let i=0,a=0;const l=e.options.penetrationDeceleration,r=e.options.penetrationAcceleration;e.__minDecelerationScrollLeft&&n<e.__minDecelerationScrollLeft?i=e.__minDecelerationScrollLeft-n:e.__maxDecelerationScrollLeft&&n>e.__maxDecelerationScrollLeft&&(i=e.__maxDecelerationScrollLeft-n),e.__minDecelerationScrollTop&&o<e.__minDecelerationScrollTop?a=e.__minDecelerationScrollTop-o:e.__maxDecelerationScrollTop&&o>e.__maxDecelerationScrollTop&&(a=e.__maxDecelerationScrollTop-o),i!==0&&(l&&i*e.__decelerationVelocityX<=0?e.__decelerationVelocityX+=i*l:r&&(e.__decelerationVelocityX=i*r)),a!==0&&(l&&a*e.__decelerationVelocityY<=0?e.__decelerationVelocityY+=a*l:r&&(e.__decelerationVelocityY=a*r))}},e},dt={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,scrollingComplete:()=>{},penetrationDeceleration:.03,penetrationAcceleration:.08},ht=function(e,t){t={...dt,...t};const n=gt();return n.customRender=e,n.options=t,n},Oe=(e,t)=>n=>o=>j(J,vt(t))(n,o.pageX-e.left+t.__scrollLeft,o.pageY-e.top+t.__scrollTop)(o),be=e=>t=>j(J,yt)(e,t.key,t.shiftKey)(t),Re=e=>t=>j(J)(e.doTouchStart,t.touches,t.timeStamp)(t),De=e=>t=>e.doTouchMove(t.touches,t.timeStamp),Me=e=>t=>e.doTouchEnd(t.timeStamp),ke=e=>t=>e.doTouchEnd(t.timeStamp),Ce=e=>t=>j(J)(e.doTouchStart,[{pageX:t.pageX,pageY:t.pageY}],t.timeStamp)(t),Xe=e=>t=>e.doTouchEnd(t.timeStamp),we=e=>t=>e??t,Fe=(e,t)=>n=>o=>St(Tt)(t.doTouchMove,[{pageX:o.pageX,pageY:o.pageY}],o.timeStamp)(n,o.pageX-e.left+t.__scrollLeft,o.pageY-e.top+t.__scrollTop)(t),St=e=>(t,...n)=>(o,...i)=>a=>e(a)?t(...n):o(...i),j=(...e)=>(t,...n)=>o=>e.reduce((i,a)=>i?a(o):!1,!0)?t(...n):null,yt=e=>e.key==="Enter",J=e=>!e.target.tagName.match(/input|textarea|select/i),vt=e=>t=>Math.abs(e.__initialTouchLeft-t.pageX)<10&&Math.abs(e.__initialTouchTop-t.pageY)<10,Tt=e=>e.__isTracking,de=Z(0),{window:Ot}=Je;function bt(e){let t,n,o,i;return{c(){t=F("section"),n=F("canvas"),this.h()},l(a){t=L(a,"SECTION",{role:!0,tabindex:!0,class:!0});var l=A(t);n=L(l,"CANVAS",{}),A(n).forEach(O),l.forEach(O),this.h()},h(){b(t,"role","grid"),b(t,"tabindex","0"),b(t,"class","h-full outline-none")},m(a,l){P(a,t,l),I(t,n),e[14](n),e[15](t),o||(i=[R(Ot,"resize",function(){D(e[4])&&e[4].apply(this,arguments)}),R(t,"click",k(C(function(){D(Oe(e[5].getBoundingClientRect(),e[3])(e[0]))&&Oe(e[5].getBoundingClientRect(),e[3])(e[0]).apply(this,arguments)}))),R(t,"keypress",function(){D(be(e[2]))&&be(e[2]).apply(this,arguments)}),R(t,"touchstart",k(C(function(){D(Re(e[3]))&&Re(e[3]).apply(this,arguments)}))),R(t,"touchmove",k(C(function(){D(De(e[3]))&&De(e[3]).apply(this,arguments)}))),R(t,"touchend",k(C(function(){D(Me(e[3]))&&Me(e[3]).apply(this,arguments)}))),R(t,"touchcancel",k(C(function(){D(ke(e[3]))&&ke(e[3]).apply(this,arguments)}))),R(t,"mousedown",k(C(function(){D(Ce(e[3]))&&Ce(e[3]).apply(this,arguments)}))),R(t,"mouseup",k(C(function(){D(Xe(e[3]))&&Xe(e[3]).apply(this,arguments)}))),R(t,"contextmenu",k(C(function(){D(we(e[3]))&&we(e[3]).apply(this,arguments)}))),R(t,"mousemove",k(C(function(){D(Fe(e[5].getBoundingClientRect(),e[3])(e[1]))&&Fe(e[5].getBoundingClientRect(),e[3])(e[1]).apply(this,arguments)})))],o=!0)},p(a,[l]){e=a},i:Se,o:Se,d(a){a&&O(t),e[14](null),e[15](null),o=!1,Ze(i)}}}function Rt(e,t,n){let o;Ke(e,de,p=>n(13,o=p));let{cellWidth:i=60}=t,{cellHeight:a=60}=t,{rows:l=10}=t,{cols:r=10}=t,s,{handleClick:_=(p,M)=>{}}=t,{handleHover:c=(p,M)=>{}}=t,{handleOffset:f=(p,M,$)=>{}}=t,{handleKeypress:g=(p,M)=>{}}=t,m,d,h,u,S,y=0,T=0,Y=i*l,he=a*r,{paint:Q=p=>(M,$,Ee,ze,Be,Pe,ee)=>{p.save(),p.translate(Ee,ze),p.fillStyle=M%2+$%2>0?"#ddd":"#fff",p.fillRect(0,0,Be,Pe),p.fillStyle="black",p.font=(14*ee).toFixed(2)+'px "Helvetica Neue", Helvetica, Arial, sans-serif',p.fillText(`${M}, ${$}`,6*ee,18*ee),p.restore()}}=t;ae(()=>{const p=d.getContext("2d");if(!p)return;h=p,S=_t(),n(3,s=ht(S.render(f,Q(h)),{bouncing:!1,locking:!1}));let M=m.getBoundingClientRect();s.setPosition(M.left+m.clientLeft,M.top+m.clientTop),n(4,u=()=>{y=m.clientWidth,T=m.clientHeight,n(6,d.width=y,d),n(6,d.height=T,d),S.setup({clientWidth:y,clientHeight:T,contentWidth:Y,contentHeight:he,tileWidth:i,tileHeight:a}),n(3,s.options.locking=window.innerWidth<=768,s),s.setDimensions(y,T,Y,he)}),u(),m.focus()});function We(p){ye[p?"unshift":"push"](()=>{d=p,n(6,d)})}function Ve(p){ye[p?"unshift":"push"](()=>{m=p,n(5,m)})}return e.$$set=p=>{"cellWidth"in p&&n(7,i=p.cellWidth),"cellHeight"in p&&n(8,a=p.cellHeight),"rows"in p&&n(9,l=p.rows),"cols"in p&&n(10,r=p.cols),"handleClick"in p&&n(0,_=p.handleClick),"handleHover"in p&&n(1,c=p.handleHover),"handleOffset"in p&&n(11,f=p.handleOffset),"handleKeypress"in p&&n(2,g=p.handleKeypress),"paint"in p&&n(12,Q=p.paint)},e.$$.update=()=>{e.$$.dirty&8216&&u&&!(s!=null&&s.__isDecelerating)&&!(s!=null&&s.__isTracking)&&u()},[_,c,g,s,u,m,d,i,a,l,r,f,Q,o,We,Ve]}class Dt extends q{constructor(t){super(),G(this,t,Rt,bt,N,{cellWidth:7,cellHeight:8,rows:9,cols:10,handleClick:0,handleHover:1,handleOffset:11,handleKeypress:2,paint:12})}}const Mt=e=>({}),Le=e=>({handleClick:e[2],handleHover:e[3],handleKeypress:e[5],handleOffset:e[4],cellWidth:W,cellHeight:V});function kt(e){let t,n,o,i,a,l,r,s;const _=e[10].default,c=re(_,e,e[9],Le);return{c(){t=F("section"),n=F("div"),c&&c.c(),o=oe(),i=F("div"),a=F("div"),l=oe(),r=F("div"),this.h()},l(f){t=L(f,"SECTION",{class:!0});var g=A(t);n=L(g,"DIV",{class:!0});var m=A(n);c&&c.l(m),m.forEach(O),o=ie(g),i=L(g,"DIV",{class:!0});var d=A(i);a=L(d,"DIV",{class:!0,style:!0}),A(a).forEach(O),l=ie(d),r=L(d,"DIV",{class:!0,style:!0}),A(r).forEach(O),d.forEach(O),g.forEach(O),this.h()},h(){b(n,"class","col-start-1 row-start-1 cursor-pointer"),b(a,"class","absolute border-2 border-red-500"),b(a,"style",e[1]),b(r,"class","absolute bg-yellow-500 opacity-30"),b(r,"style",e[0]),b(i,"class","col-start-1 row-start-1 pointer-events-none relative"),b(t,"class","grid flex-grow overflow-clip")},m(f,g){P(f,t,g),I(t,n),c&&c.m(n,null),I(t,o),I(t,i),I(i,a),I(i,l),I(i,r),s=!0},p(f,[g]){c&&c.p&&(!s||g&512)&&le(c,_,f,f[9],s?ce(_,f[9],g,Mt):se(f[9]),Le),(!s||g&2)&&b(a,"style",f[1]),(!s||g&1)&&b(r,"style",f[0])},i(f){s||(H(c,f),s=!0)},o(f){x(c,f),s=!1},d(f){f&&O(t),c&&c.d(f)}}}const W=60,V=60;function Ct(e,t,n){let o,i,{$$slots:a={},$$scope:l}=t,{interfacer:r}=t,{select:s}=t,{validTile:_}=t;const c=(u,S)=>{const[y,T]=[d(u),h(S)];_(y,T)&&(s(y,T),n(6,r.selected={x:y,y:T},r))},f=(u,S)=>{const[y,T]=[d(u),h(S)];_(y,T)&&n(6,r.hover={x:y,y:T},r)},g=(u,S,y)=>{n(6,r.offset={x:u,y:S,zoom:y},r)},m=(u,S)=>{n(6,r.key.key=u,r),n(6,r.key.shift=S,r)},d=u=>Math.floor(u/W),h=u=>Math.floor(u/V);return e.$$set=u=>{"interfacer"in u&&n(6,r=u.interfacer),"select"in u&&n(7,s=u.select),"validTile"in u&&n(8,_=u.validTile),"$$scope"in u&&n(9,l=u.$$scope)},e.$$.update=()=>{e.$$.dirty&64&&n(1,o=`left: ${r.selected.x*W-r.offset.x}px; top: ${r.selected.y*V-r.offset.y}px; width: ${W}px; height: ${V}px`),e.$$.dirty&64&&n(0,i=`left: ${r.hover.x*W-r.offset.x}px; top: ${r.hover.y*V-r.offset.y}px; width: ${W}px; height: ${V}px`)},[i,o,c,f,g,m,r,s,_,l,a]}class Xt extends q{constructor(t){super(),G(this,t,Ct,kt,N,{interfacer:6,select:7,validTile:8})}}const wt=[{url:"game/play/weather/cloud.png",frames:5,xOffset:0,yOffset:0},{url:"game/play/weather/storm.png",frames:5,xOffset:0,yOffset:0}],Ft=pe("sky",wt),Lt=e=>({select:e&1}),Ae=e=>({interfacer:e[2],select:e[0],validTile:e[1],rows:e[3],cols:e[4],renderData:e[5]});function At(e){let t;const n=e[9].default,o=re(n,e,e[8],Ae);return{c(){o&&o.c()},l(i){o&&o.l(i)},m(i,a){o&&o.m(i,a),t=!0},p(i,[a]){o&&o.p&&(!t||a&257)&&le(o,n,i,i[8],t?ce(n,i[8],a,Lt):se(i[8]),Ae)},i(i){t||(H(o,i),t=!0)},o(i){x(o,i),t=!1},d(i){o&&o.d(i)}}}function Ht(e,t,n){let{$$slots:o={},$$scope:i}=t,{map:a}=t,{makeImage:l}=t,{select:r=(m,d)=>{}}=t,s=(m,d)=>m<c&&d<f;const _=(()=>({selected:{x:-1,y:-1},hover:{x:-1,y:-1},offset:{x:0,y:0,zoom:1},key:{key:"",shift:!1}}))();let c=a.rows,f=a.cols,g={ground:m=>E(K).ground[m],unit:m=>typeof m<"u"?E(K).units[m]??null:null,sky:m=>typeof m<"u"?E(K).sky[m]??null:null};return ae(()=>{const m=Qe(l)(a.layers.ground.map(u=>u.type)),d=et(l)(a.layers.units.filter(u=>u!==null).map(u=>u.type)),h=Ft(l)(a.layers.sky.filter(u=>u!==null).map(u=>u.type));K.update(u=>(u.ground={...u.ground,...m},u.units={...u.units,...d},u.sky={...u.sky,...h},u))}),e.$$set=m=>{"map"in m&&n(6,a=m.map),"makeImage"in m&&n(7,l=m.makeImage),"select"in m&&n(0,r=m.select),"$$scope"in m&&n(8,i=m.$$scope)},[r,s,_,c,f,g,a,l,i,o]}class xt extends q{constructor(t){super(),G(this,t,Ht,At,N,{map:6,makeImage:7,select:0})}}const Ye=(e,t)=>(n,o,i)=>a=>a.drawImage(e.sprite,t.state*(n+e.xOffset),i%e.frames*(o+e.yOffset),n+e.xOffset,o+e.yOffset,-e.xOffset,-e.yOffset,n+e.xOffset,o+e.yOffset),Ut=(e,t)=>Ye(e(t.type),t),He=(e,t)=>t?Ye(e(t.type),t):null,xe=e=>t=>n=>(o,i,a,l,r,s,_)=>{var g,m;n.save(),n.scale(_,_),n.translate(a,l);const c=i+o*t.rows,f=E(de);Ut(e.ground,t.layers.ground[c])(r,s,f)(n),(g=He(e.unit,t.layers.units[c]))==null||g.call(void 0,r,s,f)(n),(m=He(e.sky,t.layers.sky[c]))==null||m.call(void 0,r,s,f)(n),n.restore()};function It(e){let t;const n=e[4].default,o=re(n,e,e[5],null);return{c(){o&&o.c()},l(i){o&&o.l(i)},m(i,a){o&&o.m(i,a),t=!0},p(i,a){o&&o.p&&(!t||a&32)&&le(o,n,i,i[5],t?ce(n,i[5],a,null):se(i[5]),null)},i(i){t||(H(o,i),t=!0)},o(i){x(o,i),t=!1},d(i){o&&o.d(i)}}}function Yt(e){let t,n;return t=new Xt({props:{interfacer:e[8],select:e[3],validTile:e[9],$$slots:{default:[Wt,({handleClick:o,handleHover:i,handleKeypress:a,handleOffset:l,cellWidth:r,cellHeight:s})=>({13:o,14:i,15:a,16:l,17:r,18:s}),({handleClick:o,handleHover:i,handleKeypress:a,handleOffset:l,cellWidth:r,cellHeight:s})=>(o?8192:0)|(i?16384:0)|(a?32768:0)|(l?65536:0)|(r?131072:0)|(s?262144:0)]},$$scope:{ctx:e}}}),{c(){fe(t.$$.fragment)},l(o){_e(t.$$.fragment,o)},m(o,i){ue(t,o,i),n=!0},p(o,i){const a={};i&256&&(a.interfacer=o[8]),i&8&&(a.select=o[3]),i&512&&(a.validTile=o[9]),i&523297&&(a.$$scope={dirty:i,ctx:o}),t.$set(a)},i(o){n||(H(t.$$.fragment,o),n=!0)},o(o){x(t.$$.fragment,o),n=!1},d(o){me(t,o)}}}function Wt(e){let t,n;return t=new Dt({props:{cellHeight:e[18],cellWidth:e[17],rows:e[10],cols:e[11],paint:xe(e[12])(e[0]),handleClick:e[13],handleHover:e[14],handleKeypress:e[15],handleOffset:e[16]}}),{c(){fe(t.$$.fragment)},l(o){_e(t.$$.fragment,o)},m(o,i){ue(t,o,i),n=!0},p(o,i){const a={};i&262144&&(a.cellHeight=o[18]),i&131072&&(a.cellWidth=o[17]),i&1024&&(a.rows=o[10]),i&2048&&(a.cols=o[11]),i&4097&&(a.paint=xe(o[12])(o[0])),i&8192&&(a.handleClick=o[13]),i&16384&&(a.handleHover=o[14]),i&32768&&(a.handleKeypress=o[15]),i&65536&&(a.handleOffset=o[16]),t.$set(a)},i(o){n||(H(t.$$.fragment,o),n=!0)},o(o){x(t.$$.fragment,o),n=!1},d(o){me(t,o)}}}function Vt(e){let t,n,o,i;const a=[Yt,It],l=[];function r(s,_){return s[2]?0:1}return t=r(e),n=l[t]=a[t](e),{c(){n.c(),o=ve()},l(s){n.l(s),o=ve()},m(s,_){l[t].m(s,_),P(s,o,_),i=!0},p(s,_){let c=t;t=r(s),t===c?l[t].p(s,_):(Ge(),x(l[c],1,1,()=>{l[c]=null}),je(),n=l[t],n?n.p(s,_):(n=l[t]=a[t](s),n.c()),H(n,1),n.m(o.parentNode,o))},i(s){i||(H(n),i=!0)},o(s){x(n),i=!1},d(s){s&&O(o),l[t].d(s)}}}function Et(e){let t,n,o,i;return document.title=ft,o=new xt({props:{map:e[0],makeImage:e[1],select:e[3],$$slots:{default:[Vt,({select:a,interfacer:l,validTile:r,rows:s,cols:_,renderData:c})=>({3:a,8:l,9:r,10:s,11:_,12:c}),({select:a,interfacer:l,validTile:r,rows:s,cols:_,renderData:c})=>(a?8:0)|(l?256:0)|(r?512:0)|(s?1024:0)|(_?2048:0)|(c?4096:0)]},$$scope:{ctx:e}}}),{c(){t=oe(),n=F("div"),fe(o.$$.fragment),this.h()},l(a){Ne("svelte-115ss56",document.head).forEach(O),t=ie(a),n=L(a,"DIV",{class:!0});var r=A(n);_e(o.$$.fragment,r),r.forEach(O),this.h()},h(){b(n,"class","flex gap-2 border-4 border-black h-full bg-stone-400")},m(a,l){P(a,t,l),P(a,n,l),ue(o,n,null),i=!0},p(a,[l]){const r={};l&1&&(r.map=a[0]),l&2&&(r.makeImage=a[1]),l&8&&(r.select=a[3]),l&7981&&(r.$$scope={dirty:l,ctx:a}),o.$set(r)},i(a){i||(H(o.$$.fragment,a),i=!0)},o(a){x(o.$$.fragment,a),i=!1},d(a){a&&(O(t),O(n)),me(o)}}}function zt(e,t,n){let{$$slots:o={},$$scope:i}=t,{map:a}=t,{makeImage:l}=t,{loaded:r}=t,{select:s}=t,_;const c=()=>{de.update(f=>(f+1)%1e5),_=setTimeout(c,800)};return ae(()=>{_=setTimeout(c,1e3)}),qe(()=>clearTimeout(_)),e.$$set=f=>{"map"in f&&n(0,a=f.map),"makeImage"in f&&n(1,l=f.makeImage),"loaded"in f&&n(2,r=f.loaded),"select"in f&&n(3,s=f.select),"$$scope"in f&&n(5,i=f.$$scope)},[a,l,r,s,o,i]}class qt extends q{constructor(t){super(),G(this,t,zt,Et,N,{map:0,makeImage:1,loaded:2,select:3})}}const Gt=Z(null),jt=Z(!1);export{qt as M,Nt as a,Kt as c,jt as l,Gt as m,ge as t,$e as u};
